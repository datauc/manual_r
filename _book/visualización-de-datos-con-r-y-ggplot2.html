<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Visualización de datos con R y ggplot2 | Manual básico de R&quot;</title>
  <meta name="description" content="Manual básico de R"" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Visualización de datos con R y ggplot2 | Manual básico de R&quot;" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Visualización de datos con R y ggplot2 | Manual básico de R&quot;" />
  
  
  

<meta name="author" content="Bastián Olea Herrera" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>



</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Manejo de datos con R</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#importación-de-datos"><i class="fa fa-check"></i><b>1.1</b> Importación de datos</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#codificación"><i class="fa fa-check"></i><b>1.2</b> Codificación</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#limpieza-de-datos"><i class="fa fa-check"></i><b>1.3</b> Limpieza de datos</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#recodificación-de-datos"><i class="fa fa-check"></i><b>1.4</b> Recodificación de datos</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#estructura-de-datos"><i class="fa fa-check"></i><b>1.5</b> Estructura de datos</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#exportación-de-datos"><i class="fa fa-check"></i><b>1.6</b> Exportación de datos</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="visualización-de-datos-con-r-y-ggplot2.html"><a href="visualización-de-datos-con-r-y-ggplot2.html"><i class="fa fa-check"></i><b>2</b> Visualización de datos con R y ggplot2</a><ul>
<li class="chapter" data-level="2.1" data-path="visualización-de-datos-con-r-y-ggplot2.html"><a href="visualización-de-datos-con-r-y-ggplot2.html#tipos-de-gráfico"><i class="fa fa-check"></i><b>2.1</b> Tipos de gráfico</a></li>
<li class="chapter" data-level="2.2" data-path="visualización-de-datos-con-r-y-ggplot2.html"><a href="visualización-de-datos-con-r-y-ggplot2.html#figuras-y-capas"><i class="fa fa-check"></i><b>2.2</b> Figuras y capas</a></li>
<li class="chapter" data-level="2.3" data-path="visualización-de-datos-con-r-y-ggplot2.html"><a href="visualización-de-datos-con-r-y-ggplot2.html#texto"><i class="fa fa-check"></i><b>2.3</b> Texto</a></li>
<li class="chapter" data-level="2.4" data-path="visualización-de-datos-con-r-y-ggplot2.html"><a href="visualización-de-datos-con-r-y-ggplot2.html#escalas"><i class="fa fa-check"></i><b>2.4</b> Escalas</a></li>
<li class="chapter" data-level="2.5" data-path="visualización-de-datos-con-r-y-ggplot2.html"><a href="visualización-de-datos-con-r-y-ggplot2.html#colores"><i class="fa fa-check"></i><b>2.5</b> Colores</a></li>
<li class="chapter" data-level="2.6" data-path="visualización-de-datos-con-r-y-ggplot2.html"><a href="visualización-de-datos-con-r-y-ggplot2.html#leyendas"><i class="fa fa-check"></i><b>2.6</b> Leyendas</a></li>
<li class="chapter" data-level="2.7" data-path="visualización-de-datos-con-r-y-ggplot2.html"><a href="visualización-de-datos-con-r-y-ggplot2.html#temas-y-espaciado"><i class="fa fa-check"></i><b>2.7</b> Temas y espaciado</a></li>
<li class="chapter" data-level="2.8" data-path="visualización-de-datos-con-r-y-ggplot2.html"><a href="visualización-de-datos-con-r-y-ggplot2.html#exportar-gráficos"><i class="fa fa-check"></i><b>2.8</b> Exportar gráficos</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Manual básico de R"</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="visualización-de-datos-con-r-y-ggplot2" class="section level1">
<h1><span class="header-section-number">2</span> Visualización de datos con R y ggplot2</h1>
<div id="introducción-a-ggplot2" class="section level4">
<h4><span class="header-section-number">2.0.0.1</span> Introducción a ggplot2</h4>
<p>Se basa en siete componentes principales:
- DATA FRAME which contains the data you’re trying to plot.
- AESTHETIC MAPPINGS determine how data are mapped to color, size, etc.
- The GEOMS (geometric objects) are what you see in the plot (points, lines, shapes)
- FACETS are the panels used in conditional plots.
- STATS are statistical transformations such as binning, quantiles, and smoothing which ggplot2 applies to the data.
- SCALES show what coding an aesthetic map uses (for example, male = red, female = blue).
- plots are depicted on a COORDINATE SYSTEM. When you use qplot these were taken care of for you.</p>
<pre><code>g+geom_point()+geom_smooth(method=&quot;lm&quot;)+facet_grid(.~drv)</code></pre>
<p>Donde <code>g</code> es un “objeto gráfico” de ggplot guardado como variable:</p>
<pre><code>g&lt;-ggplot(mpg,aes(displ,hwy))</code></pre>
<p>El primer valor <code>mpg</code> es el conjunto de datos, y luego, dentro de la función “estética” <code>aes</code>, van como argumento las dos variables que queremos graficar.
<code>geom_point()</code> es una capa que al estar vacía grafica un gráfico de dispersión.
<code>geom_smooth()</code> con su argumento vacío grafica el intervalo de confianza. Pero al llevar <code>lm</code> como argumento, grafica una línea de regresión.
<code>facet_grid(.~drv)</code> desagrega los datos en facetas según la variable indicada.
Otros elementos, como títulos <code>ggtitle</code> y etiquetas <code>ylab</code> <code>xlab</code> se añaden como suma.</p>
<p>Ejemplos:</p>
<pre><code>g+geom_point(aes(color=drv))+labs(title=&quot;Swirl Rules!&quot;)+labs(x=&quot;Displacement&quot;,y=&quot;Hwy Mileage&quot;)</code></pre>
<pre><code>g+geom_point(aes(color=drv), size=2,alpha=1/2)+geom_smooth(size=4,linetype=3,method=&quot;lm&quot;,se=FALSE)</code></pre>
<p><code>alpha</code> grafica los puntos del plot transparentes.
<code>linetype</code> vuelve la línea en intermitente.
<code>se</code> elimina el intervalo de confianza.</p>
<pre><code>g+geom_point(aes(color=drv))+theme_bw(base_family=&quot;Times&quot;)</code></pre>
<p>Graficar variable como factor (para que sólo aparezcan en el eje los valores presentes): <code>factor(variable)</code></p>
<div id="gráfico-con-múltiples-instancias-según-variable" class="section level6">
<h6><span class="header-section-number">2.0.0.1.0.1</span> Gráfico con múltiples instancias según variable</h6>
<p>Se usa la capa <code>facet</code>:</p>
<pre><code>ggplot(iris.tidy, aes(x = Species, y = Value, col = Part)) +
  geom_jitter() +
  facet_grid(. ~ Measure)</code></pre>
</div>
</div>
<div id="tipos-de-gráfico" class="section level2">
<h2><span class="header-section-number">2.1</span> Tipos de gráfico</h2>
<p>Ejemplos de los distintos tipos de gráficos que se pueden hacer en R</p>
<div id="barras" class="section level4">
<h4><span class="header-section-number">2.1.0.1</span> Barras</h4>
<pre><code>geom_bar</code></pre>
<pre><code>ggplot(Tarapaca, aes(y=Nacimientos, x=Año)) + geom_bar(stat=&quot;identity&quot;)</code></pre>
<pre><code>ggplot(df2, aes(measurements, value)) + 
  geom_line(aes(colour = samples, group = samples))</code></pre>
<p>Barras una sobre otra:</p>
<pre><code>cyl.am &lt;- ggplot(mtcars, aes(x = factor(cyl), fill = factor(am)))

## Add geom (position = &quot;stack&quot; by default)
cyl.am + 
geom_bar(position = &quot;stack&quot;)</code></pre>
<p>Barras encima de otras pero llenando el eje vertical:</p>
<pre><code>## Fill - show proportion
cyl.am + 
  geom_bar(position = &quot;fill&quot;)  </code></pre>
<p>Barras lado a lado:</p>
<pre><code>## Dodging - principles of similarity and proximity
cyl.am +
  geom_bar(position = &quot;dodge&quot;) </code></pre>
<p>Barras lado a lado pero superpuestas:</p>
<pre><code>ggplot(mtcars, aes(x = cyl, fill = am)) +
  geom_bar(position = &quot;dodge&quot;)

## 2 - Define posn_d with position_dodge()
posn_d &lt;- position_dodge(width=0.2)

## 3 - Change the position argument to posn_d
ggplot(mtcars, aes(x = cyl, fill = am)) +
  geom_bar(position = posn_d)


## 4 - Use posn_d as position and adjust alpha to 0.6
ggplot(mtcars, aes(x = cyl, fill = am)) +
  geom_bar(position = posn_d, alpha=0.6)</code></pre>
<p>Para definir el color de las barras, hay que cambiar <code>col</code> y <code>fill</code>:</p>
<pre><code>m &lt;- ggplot(mtcars, aes(x = cyl,y = wt, col = am, fill = am))</code></pre>
<p>De barras con porcentaje para variables categóricas o factores:</p>
<pre><code>ggplot(eme2, aes(x = sexo)) + 
  geom_bar(aes(y = (..count..)/sum(..count..), fill=sexo)) +
  scale_y_continuous(labels=scales::percent) +
  geom_text(aes(y = ((..count..)/sum(..count..)), 
                label = scales::percent((..count..)/sum(..count..))), 
                stat = &quot;count&quot;, 
                vjust = 4,
                color=&quot;white&quot;)</code></pre>
<div id="barra-dinamita-con-marcas-de-error" class="section level6">
<h6><span class="header-section-number">2.1.0.1.0.1</span> Barra “dinamita” (con marcas de error)</h6>
<pre><code>## Base layers
m &lt;- ggplot(mtcars, aes(x = cyl, y = wt))

## Draw dynamite plot
m +
  stat_summary(fun.y = mean, geom = &quot;bar&quot;, fill = &quot;skyblue&quot;) +
  stat_summary(fun.data = mean_sdl, fun.args = list(mult = 1), geom = &quot;errorbar&quot;, width = 0.1)</code></pre>
<pre><code>## Base layers
m &lt;- ggplot(mtcars, aes(x = cyl, y = wt))

## Set your dodge posn manually
posn.d &lt;- position_dodge(0.9)

## Plot 3: Redraw dynamite plot
m +
  stat_summary(fun.y = mean, geom = &quot;bar&quot;, position = posn.d) +
  stat_summary(fun.data = mean_sdl, fun.args = list(mult = 1), geom = &quot;errorbar&quot;, width = 0.1, position = posn.d)</code></pre>
<p>Gráfico de barras con faceta:</p>
<pre><code>ggplot(email, aes(x= number)) +
  geom_bar() +
  facet_wrap(.~spam)</code></pre>
</div>
</div>
<div id="dispersión" class="section level4">
<h4><span class="header-section-number">2.1.0.2</span> Dispersión</h4>
<p>Útil para agregar sobre boxplots.</p>
<pre><code>+ geom_jitter(color=&quot;steelblue&quot;, alpha=0.3) +
    geom_boxplot(alpha=0)</code></pre>
</div>
<div id="torta" class="section level4">
<h4><span class="header-section-number">2.1.0.3</span> Torta</h4>
<p>Representa la distribución de categorías dentro de un todo.</p>
<p>Gráfico de torta:</p>
<pre><code>## Create a stacked bar plot: wide.bar
wide.bar &lt;- ggplot(mtcars, aes(x = 1, fill = cyl)) +
              geom_bar()

## Convert wide.bar to pie chart
wide.bar +
  coord_polar(theta = &quot;y&quot;)</code></pre>
<p>Gráfico de anillo:</p>
<pre><code>## Create stacked bar plot: thin.bar
thin.bar &lt;- ggplot(mtcars, aes(x = 1, fill = cyl)) +
              geom_bar(width = 0.1) +
              scale_x_continuous(limits = c(0.5,1.5))

## Convert thin.bar to &quot;ring&quot; type pie chart
thin.bar + 
  coord_polar(theta = &quot;y&quot;)</code></pre>
<p>Definir los colores:</p>
<pre><code>scale_fill_manual(values=c(&quot;##320D70&quot;, &quot;##DF1A58&quot;))</code></pre>
<p>Torta de variable categórica o factores con porcentajes:</p>
<pre><code>eme_genero2_gg &lt;- eme2 %&gt;%
  ggplot(aes(x=1, fill=sexo)) + 
  geom_bar(position=&quot;stack&quot;,width = 0.5, aes(y = (..count..)/sum(..count..))) +
  scale_y_continuous(labels=scales::percent) +
  scale_x_continuous(limits = c(0.5,1.3)) +
  scale_fill_manual(values=c(&quot;##320D70&quot;, &quot;##DF1A58&quot;)) +
  geom_text(aes(y = ((..count..)/sum(..count..)), 
              label = scales::percent((..count..)/sum(..count..))), 
              stat = &quot;count&quot;, 
              vjust = -9,
              color=&quot;white&quot;) +
    theme(axis.title = element_blank(),
      axis.text = element_blank(),
      axis.ticks = element_blank(),
      rect = element_blank(),
      panel.grid = element_blank(),
      legend.title = element_blank(),
      legend.direction = &quot;horizontal&quot;,
      legend.position = &quot;bottom&quot;) +
    labs(title=&quot;Microemprendedores según género&quot;) +
  coord_polar(theta = &quot;y&quot;)</code></pre>
<p>Ejemplo:</p>
<pre><code>eme_genero_gg &lt;- eme2 %&gt;%
    ggplot(aes(x = 1, sexo, fill = sexo)) +
   geom_col() +
    scale_fill_manual(values=c(&quot;##320D70&quot;, &quot;##DF1A58&quot;)) +
    coord_polar(theta = &quot;y&quot;) +
    theme(axis.title = element_blank(),
        axis.text = element_blank(),
        axis.ticks = element_blank(),
        rect = element_blank(),
        panel.grid = element_blank(),
        legend.title = element_blank(),
  legend.direction = &quot;horizontal&quot;,
legend.position = &quot;bottom&quot;) +
  labs(title=&quot;Microemprendedores según género&quot;)

eme_genero_gg
</code></pre>
<p>Ejemplo:</p>
<pre><code>extranjeros_verano &lt;- turismo %&gt;%
    filter(periodo==&quot;Verano&quot;) %&gt;%
    mutate(extranjeros = case_when(nacionalidad == &quot;Chile&quot; ~ &quot;Chilena&quot;,
                                   TRUE ~ &quot;Extranjera&quot;)) %&gt;%
    group_by(extranjeros) %&gt;%
    summarize(cantidad = n()) %&gt;%
    ggplot(aes(x=1, y=cantidad, fill=extranjeros)) +
    geom_col() +
    coord_polar(theta = &quot;y&quot;, start=0, direction = -1) +
    scale_fill_discrete(name = &quot;Nacionalidad&quot;) +
    theme(axis.text = element_blank(), axis.title = element_blank()) +
    ##geom_text(aes(x=1, y = cumsum(cantidad) - cantidad/3, label = percent(cantidad/sum(cantidad)))) +
    geom_text(aes(label = percent(cantidad/sum(cantidad), accuracy=1)), position = position_stack(vjust = 0.5)) +
    labs(subtitle=&quot;Verano&quot;)</code></pre>
</div>
<div id="densidad" class="section level4">
<h4><span class="header-section-number">2.1.0.4</span> Densidad</h4>
<pre><code>geom_density</code></pre>
<p>El gráfico de densidad es una línea curva de la silueta del histograma:</p>
<pre><code>ggplot(common_cyl, aes(x = city_mpg, fill = as.factor(ncyl))) +
  geom_density(alpha = .3)</code></pre>
<p>La desviación estándar <code>bw</code> suaviza el histograma.</p>
<pre><code>ggplot(truck_speeding, aes(x = hour_of_day)) +
    ## switch to density with bin width of 1.5, keep fill 
    geom_density(fill = &#39;steelblue&#39;, bw=1.5) +
    ## add a subtitle stating binwidth
    labs(title = &#39;Citations by hour&#39;, subtitle= &quot;Gaussian kernel SD= 1.5&quot;)</code></pre>
<p>Parámetros:
- <code>bw</code> - the smoothing bandwidth to be used, see ?density for details
- <code>adjust</code> - adjustment of the bandwidth, see density for details
- <code>kernel</code> - kernel used for density estimation, defined as
- “g” = gaussian
- “r” = rectangular
- “t” = triangular
- “e” = epanechnikov
- “b” = biweight
- “c” = cosine
- “o” = optcosine</p>
</div>
<div id="boxplot" class="section level4">
<h4><span class="header-section-number">2.1.0.5</span> Boxplot</h4>
<pre><code>ggplot(aes(x = 1, y = city_mpg)) +
  geom_boxplot()</code></pre>
<p>Se puede poner 1 en el eje x para mostrar solo un boxplot.</p>
<p>El ancho de cada caja puede depender de la cantidad de casos:</p>
<pre><code>geom_boxplot(varwidth=TRUE)</code></pre>
</div>
<div id="curvas-y-modelos-lineales" class="section level4">
<h4><span class="header-section-number">2.1.0.6</span> Curvas y modelos lineales</h4>
<p>Agregar líneas de regresión al gráfico</p>
<pre><code>geom_smooth</code></pre>
<p>Curva Loess:</p>
<pre><code>ggplot(mtcars, aes(x = wt, y = mpg)) +
  geom_point() +
  geom_smooth()</code></pre>
<p>Cambiar</p>
<p>Línea de regresión:</p>
<pre><code>ggplot(mtcars, aes(x = wt, y = mpg)) +
  geom_point() +
  geom_smooth(method=&quot;lm&quot;, se=FALSE) ## línea de regresión</code></pre>
<p>Ejemplo:</p>
<pre><code>ggplot(mtcars, aes(x = wt, y = mpg, col = factor(cyl))) +
  geom_point() +
  stat_smooth(method = &quot;lm&quot;, se = FALSE) +
  stat_smooth(method = &quot;lm&quot;, se = FALSE, aes(group=1))</code></pre>
<pre><code>myColors &lt;- c(brewer.pal(3, &quot;Dark2&quot;), &quot;black&quot;)

ggplot(mtcars, aes(x = wt, y = mpg, col = factor(cyl))) +
  geom_point() +
  stat_smooth(method = &quot;lm&quot;, se = FALSE, span = 0.7) +
  stat_smooth(method = &quot;loess&quot;, 
              aes(group = 1, col=&quot;All&quot;), 
              se = FALSE, span = 0.7) +
  scale_color_manual(&quot;Cylinders&quot;, values=myColors)</code></pre>
</div>
<div id="barras-redondeadas" class="section level4">
<h4><span class="header-section-number">2.1.0.7</span> Barras redondeadas</h4>
<pre><code>library(ggchicklet)

ggplot(count(mtcars, cyl), aes(x = cyl, y = n)) +
  geom_chicklet(radius = grid::unit(15, &#39;mm&#39;), fill = &#39;skyblue&#39;) +
  theme_minimal()</code></pre>
</div>
<div id="nubes-de-palabras" class="section level4">
<h4><span class="header-section-number">2.1.0.8</span> Nubes de palabras</h4>
<p><a href="https://medium.com/@rohitnair_94843/analysis-of-twitter-data-using-r-part-2-word-cloud-dd423af1b2c6">https://medium.com/<span class="citation">@rohitnair</span>_94843/analysis-of-twitter-data-using-r-part-2-word-cloud-dd423af1b2c6</a></p>
<p><a href="https://www.r-bloggers.com/awesome-twitter-word-clouds-in-r/">https://www.r-bloggers.com/awesome-twitter-word-clouds-in-r/</a></p>
</div>
<div id="convertir-a-3d" class="section level4">
<h4><span class="header-section-number">2.1.0.9</span> Convertir a 3D</h4>
<p><a href="https://www.rayshader.com">https://www.rayshader.com</a></p>
</div>
<div id="estadísticas-en-gráficos" class="section level4">
<h4><span class="header-section-number">2.1.0.10</span> Estadísticas en gráficos</h4>
<p>Curva normal:</p>
<pre><code>+ stat_function</code></pre>
<pre><code>## Plot 2: Mean and SD - the easy way
wt.cyl.am +
stat_summary(fun.data=mean_sdl, fun.args=list(mult=1), position=posn.d)


## Plot 3: Mean and 95% CI - the easy way
wt.cyl.am +
stat_summary(fun.data=mean_cl_normal, position=posn.d)


## Plot 4: Mean and SD - with T-tipped error bars - fill in ___
wt.cyl.am +
  stat_summary(geom = &quot;point&quot;, fun.y = mean,
               position = posn.d) +
  stat_summary(geom = &quot;errorbar&quot;, fun.data = mean_sdl,
               position = posn.d, fun.args = list(mult = 1), width = 0.1)</code></pre>
</div>
<div id="crestas" class="section level4">
<h4><span class="header-section-number">2.1.0.11</span> Crestas</h4>
<pre><code>library(ggridges)
p + geom_density_ridges()</code></pre>
<pre><code>md_speeding %&gt;% 
    mutate(day_of_week = factor(day_of_week, levels = c(&quot;Mon&quot;,&quot;Tues&quot;,&quot;Wed&quot;,&quot;Thu&quot;,&quot;Fri&quot;,&quot;Sat&quot;,&quot;Sun&quot;) )) %&gt;% 
    ggplot(aes( x = percentage_over_limit, y = day_of_week)) + 
    ## make ridgeline densities a bit see-through with alpha = 0.7
    geom_density_ridges(bandwidth = 3.5, alpha=0.7) +
    ## set expand values to c(0,0)
    scale_x_continuous(limits = c(0,150), expand=c(0,0)) +
    labs(subtitle = &#39;Guassian kernel SD = 3.5&#39;) +
    ## remove y axis ticks
    theme(axis.ticks.y=element_blank())</code></pre>
</div>
<div id="enjambre" class="section level4">
<h4><span class="header-section-number">2.1.0.12</span> Enjambre</h4>
<p>Alternativa al boxplot. Agrega dispersión de forma inteligente, con los puntos lo más cercanos al eje.</p>
<pre><code>library(ggbeeswarm)
p + geom_beeswarm()</code></pre>
<p>Muestra todos los puntos de datos y la forma de la distribución.
Funciona mal con demasiados datos.</p>
<p>Cambiar el tamaño de los puntos:</p>
<pre><code>geom_beeswarm(cex=0.5) +</code></pre>
</div>
<div id="violín" class="section level4">
<h4><span class="header-section-number">2.1.0.13</span> Violín</h4>
<p>Alternativa al boxplot. Muestra la distirbución de forma simétrica.</p>
<pre><code>geom_violin()</code></pre>
<p>Funciona bien con muchos datos, pero no muestra cada dato individualmente.</p>
<pre><code>geom_violin(bw = 2.5) +</code></pre>
</div>
<div id="líneas" class="section level4">
<h4><span class="header-section-number">2.1.0.14</span> Líneas</h4>
<pre><code>geom_line</code></pre>
<pre><code>ggplot(economics, aes(x = date, y = unemploy/pop)) +
geom_line()</code></pre>
<pre><code>ggplot(fish.tidy, aes(x = Year, y = Capture, color=Species)) + geom_line()</code></pre>
<pre><code>ggplot(ChickWeight, aes(x = Time, y = weight, col=Diet)) +
  geom_line(aes(group = Chick), alpha=0.3) +
  geom_smooth(lwd=2, se=FALSE)</code></pre>
<p>Seis mapas de líneas horizontalmente:</p>
<pre><code>ggplot(barley, aes(x=year, y=yield, col=variety, group=variety)) +
geom_line() +
facet_wrap( ~ site, nrow= 1)</code></pre>
<p>Planos de líneas de promedios con desviación estándar como barritas transparentes:</p>
<pre><code>## Create overlapping ribbon plot from scratch
ggplot(barley, aes(year, yield, col= site, group=site, fill=site)) +
stat_summary(fun.y=mean, geom=&quot;line&quot;) +
stat_summary(fun.data=mean_sdl, fun.args=list(mult=1), geom=&quot;ribbon&quot;, col=NA, alpha=0.1)</code></pre>
</div>
<div id="histograma" class="section level4">
<h4><span class="header-section-number">2.1.0.15</span> Histograma</h4>
<pre><code>geom_histogram</code></pre>
<p>A mayor <code>binwidth</code>, más gruesas las líneas.
<code>bins</code> es el número de barras.
<code>center</code> hace que la barra central esté en un punto determinado.</p>
<pre><code>ggplot(mtcars, aes(x = mpg)) +
  geom_histogram(aes(y=..density..), binwidth=1, bins=40, fill=&quot;##377EB8&quot;)</code></pre>
<pre><code>ggplot(adult, aes(SRAGE_P, fill=factor(RBMI))) + geom_histogram(binwidth=1)</code></pre>
<pre><code>qplot(var1,data=datos,fill=var2)</code></pre>
<p>Con color</p>
<pre><code>qplot(var1,var2,data=datos,facets=.~var3)</code></pre>
<p>Tres histogramas horizontalmente, divididos por variable 3.</p>
<pre><code>qplot(var1,data=datos,facets=var2~.,binwidth=2)</code></pre>
<p>Tres histogramas, uno encima del otro.</p>
<p>Polígono de frecuencias:</p>
<pre><code>ggplot(mtcars, aes(mpg, color=cyl)) +
  geom_freqpoly(binwidth=1)</code></pre>
<p>Alfombra de casos:</p>
<pre><code>+ geom_rug</code></pre>
</div>
<div id="dumbell" class="section level4">
<h4><span class="header-section-number">2.1.0.16</span> Dumbell</h4>
<pre><code>ggplot(first_last, aes(x = series, y = viewers, color = episode)) +
  geom_point() + ## keep
  geom_line(aes(group = series)) + ## keep
  coord_flip() ## keep</code></pre>
</div>
<div id="mapas-de-calor" class="section level4">
<h4><span class="header-section-number">2.1.0.17</span> Mapas de calor</h4>
<pre><code>geom_tile</code></pre>
<pre><code>## Create color palette
myColors &lt;- brewer.pal(9, &quot;Reds&quot;)

## Build the heat map from scratch
ggplot(barley, aes(x = year, y = variety, fill = yield)) +
  geom_tile() + ## Geom layer
  facet_wrap( ~ site, ncol = 1) + ## Facet layer
  scale_fill_gradientn(colors = myColors) ## Adjust colors</code></pre>
</div>
<div id="splom-scatterplot-matrix" class="section level4">
<h4><span class="header-section-number">2.1.0.18</span> Splom (scatterplot matrix)</h4>
<pre><code>pairs(datos)</code></pre>
<pre><code>library(PerformanceAnalytics)
chart.Correlation(iris[1:4])</code></pre>
<pre><code>library(GGAlly)
ggpairs(datos[1:9])</code></pre>
</div>
<div id="matriz-de-correlación" class="section level4">
<h4><span class="header-section-number">2.1.0.19</span> Matriz de correlación</h4>
</div>
<div id="coordenadas-paralelas" class="section level4">
<h4><span class="header-section-number">2.1.0.20</span> Coordenadas paralelas</h4>
<pre><code>ggparcoord(datos, columns =1:4, groupColumn=5, scale=&quot;globalminmax&quot;, order=&quot;anyClass&quot;, alphaLines=0.4)</code></pre>
</div>
<div id="mapas" class="section level4">
<h4><span class="header-section-number">2.1.0.21</span> Mapas</h4>
<p>Mapoteca congreso nacional:
<a href="https://www.bcn.cl/siit/mapas_vectoriales/index_html">https://www.bcn.cl/siit/mapas_vectoriales/index_html</a></p>
<p><a href="http://guillermoacuna.blogspot.com/2017/02/como-hacer-un-mapa-de-chile-en-r.html">http://guillermoacuna.blogspot.com/2017/02/como-hacer-un-mapa-de-chile-en-r.html</a></p>
<p><a href="https://geocompr.robinlovelace.net/adv-map.html">https://geocompr.robinlovelace.net/adv-map.html</a></p>
<pre><code>  tm_fill() +
  tm_borders() </code></pre>
<p><a href="https://eriqande.github.io/rep-res-web/lectures/making-maps-with-R.html">https://eriqande.github.io/rep-res-web/lectures/making-maps-with-R.html</a></p>
</div>
<div id="mapa-de-densidad" class="section level4">
<h4><span class="header-section-number">2.1.0.22</span> Mapa de densidad</h4>
<p>Mapa lineal de densidad, como un mapa topográfico:</p>
<pre><code>geom_density_2d()</code></pre>
<p>Mapa con degradado de calor:</p>
<pre><code>geom_density_2d(geom=&quot;tile&quot;, aes(fill=..density..), contour=FALSE)</code></pre>
<p>Mapa de círculos:</p>
<pre><code>geom_density_2d(geom=&quot;point&quot;, aes(fill=..density..), n=20, contour=FALSE) + 
scale_size(range=c(0,9))</code></pre>
<p>Agregar línea de medianas:</p>
<pre><code>p+geom_vline(data=mu, aes(xintercept=grp.mean, color=sex),
             linetype=&quot;dashed&quot;)</code></pre>
</div>
<div id="scatter" class="section level4">
<h4><span class="header-section-number">2.1.0.23</span> Scatter</h4>
<p>Permiten explorar preguntas e hipótesis iniciales, sugerir estrategias para siguientes pasos, y resumir los datos gráficamente para destacar características generales.</p>
<pre><code>geom_point</code></pre>
<p>Requiere especificar x e y.</p>
<pre><code>ggplot(df, aes(x = wt, y = mpg)) + geom_point()</code></pre>
<p>Cambiar color y forma:</p>
<pre><code>b + geom_point(color = &quot;##00AFBB&quot;, size = 2, shape = 23)</code></pre>
<p>Cambiar forma de los puntos según otra variable:</p>
<pre><code>b + geom_point(aes(shape = cyl))</code></pre>
<p>Cambiar forma y color de los puntos según otras variables:</p>
<pre><code>b + geom_point(aes(shape = cyl, color = cyl))   </code></pre>
<p>Para colores personalizados: <code>+ scale_color_manual(values = c("##00AFBB", "##E7B800", "##FC4E07")</code></p>
<p>Texto del eje x: rotar y mostrar todos los valores:</p>
<pre><code>+ scale_x_continuous(&quot;Año&quot;, labels = as.character(Año), breaks = Año)</code></pre>
<p>Definir mínimos y máximos:</p>
<pre><code>+ coord_cartesian(ylim = c(800, 5500)) ## especificar mínimos y máximos del eje y</code></pre>
<p>Añadir dispersión a los puntos:</p>
<pre><code>jitter can be 1) an argument in geom_point(position = &#39;jitter&#39;), 2) a geom itself, geom_jitter(), or 3) a position function, position_jitter(0.1)</code></pre>
<hr />
<p>Ejemplo de scatter:</p>
<pre><code>ggplot(Vocab, aes(x=education, y=vocabulary)) + geom_jitter(alpha=0.2, shape=1)</code></pre>
<p>Ejemplo:</p>
<pre><code>gD&lt;- ggplot(Tarapaca, aes(x = Año, y = Defunciones))

gD+ geom_smooth(se=FALSE, alpha=10, size=0.5, color=&quot;##C19BDE&quot;) + ##línea de tendencia, falso para no mostrar intervalos
    geom_point(aes(size = TasaMortalidad), alpha = 0.7, color = &quot;##8A1CDD&quot;) + ##variable graficada como &quot;size&quot;, con color y transparencia
    scale_size(range = c(0.5, 10)) + ##rango del tamaño de círculos
    theme(axis.text.x = element_text(angle = 45, vjust = 0.5)) + ##ángulo del texto del eje x
    scale_x_continuous(&quot;Año&quot;, labels = as.character(Año), breaks = Año) + ##etiquetas del eje x
    theme(panel.grid.major = element_line(Año, color = &quot;white&quot;), ## líneas del fondo
          panel.grid.minor = element_blank(), ## borrar líneas menores
          panel.background = element_rect(fill = &quot;##EDE6F2&quot;), ## color de fondo
          legend.key = element_rect(fill = &quot;##EDE6F2&quot;)) + ## color de fondo de leyenda
    labs(size=&quot;Tasa de mortalidad&quot;) + ##título del elemento &quot;size&quot;
    coord_cartesian(ylim = c(800, 5500)) ## especificar mínimos y máximos del eje y</code></pre>
<p>Ejemplo de scatter con dos variables:</p>
<pre><code>gX &lt;- ggplot(Tarapaca)
gX + geom_point(aes(y=Nacimientos , x=Año, size=TasaNatalidad, colour=TasaFecundidad), alpha = 0.7, color = &quot;##DD4814&quot;) + 
    geom_point(aes(y = Defunciones, x=Año, size=TasaMortalidad), alpha = 0.7, color = &quot;##8A1CDD&quot;) + 
    ##geom_point(aes(y = , x=Año, size=Nacimientos), alpha = 0.7, color = &quot;##DD4814&quot;)
    scale_size(range = c(2, 15)) + ##rango del tamaño de círculos
    theme(axis.text.x = element_text(angle = 45, vjust = 0.5)) + ##ángulo del texto del eje x
    scale_x_continuous(&quot;Año&quot;, labels = as.character(Año), breaks = Año) + ##etiquetas del eje x
    theme(panel.grid.major = element_line(Año, color = &quot;white&quot;), ## líneas del fondo
          panel.grid.minor = element_blank(), ## borrar líneas menores
          panel.background = element_rect(fill = &quot;##EDE6F2&quot;), ## color de fondo
          legend.key = element_rect(fill = &quot;##EDE6F2&quot;)) + ## color de fondo de leyenda
    labs(size=&quot;Tasa de mortalidad&quot;) ##título del elemento &quot;size&quot;</code></pre>
<p>Ejemplo de qplot:</p>
<pre><code>qplot(wt, mpg, data = mtcars)</code></pre>
</div>
<div id="gráficos-con-iconos-o-logotipos" class="section level4">
<h4><span class="header-section-number">2.1.0.24</span> Gráficos con iconos o logotipos</h4>
<p>Instalar iconos de símbolos como FontAwesome o IonIcons</p>
<p>Luego graficar con <code>geom_text</code> usando el código del glifo a utilizar:</p>
<pre><code>geom_text(label=&quot;\uF236&quot;, size = 14, family = &#39;FontAwesome&#39;, col=&quot;##1C2366&quot;) +</code></pre>
</div>
<div id="waffle" class="section level4">
<h4><span class="header-section-number">2.1.0.25</span> Waffle</h4>
<pre><code>disease_counts &lt;- who_disease %&gt;%
    group_by(disease) %&gt;%
    summarise(total_cases = sum(cases)) %&gt;% 
    mutate(percent = round(total_cases/sum(total_cases)*100))

## Create an array of rounded percentages for diseases.
case_counts &lt;- disease_counts$percent
## Name the percentage array
names(case_counts) &lt;- disease_counts$disease

## Pass case_counts vector to the waffle function to plot
waffle(case_counts)</code></pre>
<pre><code>parts &lt;- c(80, 30, 20, 10)
chart &lt;- waffle(parts, rows=8)
## print(chart)

## library(extrafont)
## waffle(parts, rows=8, use_glyph=&quot;shield&quot;)

parts &lt;- c(One=80, Two=30, Three=20, Four=10)
chart &lt;- waffle(parts, rows=8)
## print(chart)
</code></pre>
<pre><code>library(waffle)

parts &lt;- c(&#39;TRUE&#39; = 3, &#39;FALSE&#39; = 77)
p &lt;- waffle(parts, rows = 8, colors = c(&quot;black&quot;, &quot;grey70&quot;))
p</code></pre>
<p>Ejemplo:</p>
<pre><code>originarios_total &lt;- read_excel(&quot;/Users/rndzvs/RStudio/Tarapacá\ R/Indígenas.xlsx&quot;,
                                sheet=&quot;Región&quot;)

originarios_total

originarios_total_tidy &lt;- originarios_total %&gt;%
  gather(`Pueblo originario`, Porcentaje, Aimara:`Sin pertenencia`) %&gt;%
  mutate_if(is.character, as.factor)

originarios_total_tidy

## Explorar porcentajes de cada pueblo en total
originarios_total_tidy %&gt;%
  group_by(`Pueblo originario`) %&gt;%
  ##filter(`Pueblo originario`==&quot;Aimara&quot;) %&gt;%
  summarize(percent(Porcentaje/10))

originarios_desagregado_tidy

pueblos_originarios_vector &lt;- c(Aimara=29.1, Diaguita=1.44, Mapuche=2.18, Quechua=3.24, `Otra etnia`=3.24, `Sin pertenencia`=62.5)

pueblos_originarios_waffle &lt;- waffle(pueblos_originarios_vector, 
                                     rows=9, 
                                     size=2)

pueblos_originarios_waffle_gg &lt;- pueblos_originarios_waffle + 
  labs(title=&quot;Pertenencia a pueblos originarios&quot;, 
       subtitle=&quot;Cada cuadro representa a 1 de cada 100 tarapaqueños&quot;) +
  scale_fill_manual(values=c(&quot;##1A9D75&quot;, ##aymara
                             &quot;##69A500&quot;, ##diaguita
                             &quot;##7370B5&quot;, ##mapuche
                             &quot;##DB6200&quot;, ##quechua
                             &quot;##E8348B&quot;, ##otros
                             &quot;##AFAFAF&quot;, ##sin
                             &quot;##FFFFFF&quot; ##fondo
                             )) +
  tema_comparaciones2 +
  theme(legend.title = element_blank(),
        legend.position = &quot;bottom&quot;)

pueblos_originarios_waffle_gg</code></pre>
</div>
<div id="voronoi" class="section level4">
<h4><span class="header-section-number">2.1.0.26</span> Voronoi</h4>
<p><a href="https://rspatial_es.gitlab.io/blog/2020-08-02-diagrama-voronoi-r-ggplot/">https://rspatial_es.gitlab.io/blog/2020-08-02-diagrama-voronoi-r-ggplot/</a></p>
</div>
<div id="densidad-2d" class="section level4">
<h4><span class="header-section-number">2.1.0.27</span> Densidad 2D</h4>
<p>Densidad con líneas concéntricas:</p>
<pre><code>## Base layers
p &lt;- ggplot(faithful, aes(x = waiting, y = eruptions)) +
  scale_y_continuous(limits = c(1, 5.5), expand = c(0, 0)) +
  scale_x_continuous(limits = c(40, 100), expand = c(0, 0)) +
  coord_fixed(60 / 4.5)

## 1 - Use geom_density_2d()
p + geom_density_2d()

## 2 - Use stat_density_2d() with arguments
p + stat_density_2d(aes(col = ..level..), h = c(5, 0.5))</code></pre>
<p>Densidad con gradiente:</p>
<pre><code>## Load in the viridis package
library(viridis)

## Add viridis color scale
ggplot(faithful, aes(x = waiting, y = eruptions)) +
  scale_y_continuous(limits = c(1, 5.5), expand = c(0,0)) +
  scale_x_continuous(limits = c(40, 100), expand = c(0,0)) +
  coord_fixed(60/4.5) +
  stat_density_2d(geom = &quot;tile&quot;, aes(fill = ..density..), h=c(5,.5), contour = FALSE) +
  scale_fill_viridis()
</code></pre>
</div>
<div id="gráficos-animados" class="section level4">
<h4><span class="header-section-number">2.1.0.28</span> Gráficos animados</h4>
<pre><code>library(gganimate)
library(tween)
library(ggplot2)</code></pre>
<div id="animar-según-otra-variable" class="section level6">
<h6><span class="header-section-number">2.1.0.28.0.1</span> Animar según otra variable</h6>
<pre><code>p&lt;- ggplot(iris, aes(x = Petal.Width, y = Petal.Length)) +
    geom_point() + ##Gráfico de dispersión común
    transition_states(Species, ##Anima los puntos según variable
                    transition_length = 2,
                    state_length = 1) + 
    ease_aes(&#39;cubic-in-out&#39;) + ##suavizar animación
    ggtitle(&#39;Now showing {closest_state}&#39;,
          subtitle = &#39;Frame {frame} of {nframes}&#39;) ##Título con estados de la animación</code></pre>
<p><code>transition_states()</code> splits up plot data by a discrete variable and animates between the different states.
<code>ease_aes()</code> defines the velocity with which aesthetics change during an animation.</p>
</div>
<div id="animar-transiciones-de-entrada-y-salida" class="section level6">
<h6><span class="header-section-number">2.1.0.28.0.2</span> Animar transiciones de entrada y salida:</h6>
<pre><code>anim &lt;- ggplot(iris, aes(x = Petal.Width, y = Petal.Length)) + 
  geom_point(aes(colour = Species), size = 2) + 
  transition_states(Species,
                    transition_length = 2,
                    state_length = 1)
anim + 
  enter_fade() + 
  exit_shrink()</code></pre>
<p><code>enter</code> and <code>exit</code> functions are used to modify the aesthetics of appearing and disappearing data so that their entrance or exit may be animated.</p>
</div>
<div id="agregar-título" class="section level6">
<h6><span class="header-section-number">2.1.0.28.0.3</span> Agregar título</h6>
<p>Si es <code>transition_reveal</code>:</p>
<pre><code>labs(x = &quot;Años&quot;, y = &quot;Nacimientos&quot;, title=&quot;Año {as.integer(frame_along)}&quot;) +</code></pre>
<p>Si es <code>transition_states</code>:</p>
<pre><code>labs(x = &quot;Años&quot;, y = &quot;Nacimientos&quot;, title=&quot;Año {closest_state}&quot;) +</code></pre>
<pre><code>ggtitle(&#39;Año {closest_state}&#39;) ##título de años</code></pre>
</div>
<div id="exportar" class="section level6">
<h6><span class="header-section-number">2.1.0.28.0.4</span> Exportar:</h6>
<pre><code>animate(gA_anim, nframes=300, fps=24, width=750, height=675, res=150, end_pause = 30)
anim_save(&quot;Animación2.gif&quot;, animation = last_animation())</code></pre>
<p><code>nframes</code> es la cantidad total de cuadros de la animación
<code>fps</code> son los cuadros por segundo de la animación
<code>end_pause</code> son cuadros de pausa al final de la animación
<code>rewind=TRUE</code> para rebobinar.</p>
<p>Ejemplo:</p>
<pre><code>library(ggplot2)
library(gganimate)

p&lt;- ggplot(iris, aes(x = Petal.Width, y = Petal.Length)) +
    geom_point() + ##Gráfico de dispersión común
    transition_states(Species, transition_length = 2, state_length = 1) + ##Anima los puntos según variable
    ease_aes(&#39;cubic-in-out&#39;) + ##suavizar animación
    ggtitle(&#39;Now showing {closest_state}&#39;,
            subtitle = &#39;Frame {frame} of {nframes}&#39;) ##Título con estados de la animación

animate(p, nframes=300, fps=30) 
anim_save(&quot;Animación2.gif&quot;, animation = last_animation())</code></pre>
<p><a href="https://www.datanovia.com/en/blog/gganimate-how-to-create-plots-with-beautiful-animation-in-r/##show-preceding-frames-with-gradual-falloff">https://www.datanovia.com/en/blog/gganimate-how-to-create-plots-with-beautiful-animation-in-r/##show-preceding-frames-with-gradual-falloff</a></p>
<p>Regresión:
<a href="http://varianceexplained.org/files/loess.html">http://varianceexplained.org/files/loess.html</a></p>
</div>
<div id="gráficos-de-países-que-se-van-adelantando" class="section level6">
<h6><span class="header-section-number">2.1.0.28.0.5</span> Gráficos de países que se van adelantando</h6>
<ul>
<li><a href="https://towardsdatascience.com/create-animated-bar-charts-using-r-31d09e5841da">https://towardsdatascience.com/create-animated-bar-charts-using-r-31d09e5841da</a></li>
<li><a href="https://stackoverflow.com/questions/53162821/animated-sorted-bar-chart-with-bars-overtaking-each-other?source=post_page---------------------------">https://stackoverflow.com/questions/53162821/animated-sorted-bar-chart-with-bars-overtaking-each-other?source=post_page—————————</a></li>
</ul>
<pre><code>nata&lt;-read.csv(&quot;nata.csv&quot;, sep=&quot;;&quot;)

names(nata)[2] &lt;- &quot;2000&quot;
names(nata)[3] &lt;- &quot;2001&quot;
names(nata)[4] &lt;- &quot;2002&quot;
names(nata)[5] &lt;- &quot;2003&quot;
names(nata)[6] &lt;- &quot;2004&quot;
names(nata)[7] &lt;- &quot;2005&quot;
names(nata)[8] &lt;- &quot;2006&quot;
names(nata)[9] &lt;- &quot;2007&quot;
names(nata)[10] &lt;- &quot;2008&quot;
names(nata)[11] &lt;- &quot;2009&quot;
names(nata)[12] &lt;- &quot;2010&quot;
names(nata)[13] &lt;- &quot;2011&quot;
names(nata)[14] &lt;- &quot;2012&quot;
names(nata)[15] &lt;- &quot;2013&quot;
names(nata)[16] &lt;- &quot;2014&quot;
names(nata)[17] &lt;- &quot;2015&quot;
names(nata)[18] &lt;- &quot;2016&quot;

library(ggplot2)
library(gganimate)
library(tidyverse)
library(janitor)
library(scales)


#### Aplicar guía a mis datos
            
#### Cambiar formato de base de datos a &quot;long format&quot;
nata_tidy &lt;- nata %&gt;% 
      mutate_at(vars(contains(&quot;20&quot;)),as.numeric) %&gt;% ##selecionar los años 
      gather(year,value,2:18) %&gt;% ##elegir las columnas de los años
      janitor::clean_names() %&gt;% 
      mutate(year = as.numeric(stringr::str_sub(year,1,4)))

write_csv(nata_tidy,&quot;nata_tidy.csv&quot;)
View(nata_tidy)
View(nata)

#### We’re going to filter our dataset to retain only the top 10 countries for every given year

nata_tidy &lt;- read_csv(&quot;nata_tidy.csv&quot;)
nata_formatted &lt;- nata_tidy %&gt;%
      group_by(year) %&gt;%
      ## The * 1 makes it possible to have non-integer ranks while sliding
      mutate(rank = rank(-value),
             Value_rel = value/value[rank==1],
             Value_lbl = paste0(&quot; &quot;,round(value/1e9))) %&gt;%
      group_by(region) %&gt;% 
      filter(rank &lt;=10) %&gt;%
      ungroup()

View(nata_formatted)

#### Gráfico seguido de animación

staticplot = ggplot(nata_formatted, aes(rank, group = region, 
                                       fill = as.factor(region), 
                                       color = as.factor(region))) +
      geom_tile(aes(y = value/2,
                    height = value,
                    width = 0.9), alpha = 0.8, color = NA) +
      geom_text(aes(y = 0, label = paste(region, &quot; &quot;)), vjust = 0.2, hjust = 1) +
      geom_text(aes(y=value,label = paste(round(value,digits= 1)), hjust=-0.2)) +
      coord_flip(clip = &quot;off&quot;, expand = FALSE) +
      scale_y_continuous(labels = scales::comma) +
      scale_x_reverse() +
      guides(color = FALSE, fill = FALSE) +
      theme(axis.line=element_blank(),
            axis.text.x=element_blank(),
            axis.text.y=element_blank(),
            axis.ticks=element_blank(),
            axis.title.x=element_blank(),
            axis.title.y=element_blank(),
            legend.position=&quot;none&quot;,
            panel.background=element_blank(),
            panel.border=element_blank(),
            panel.grid.major=element_blank(),
            panel.grid.minor=element_blank(),
            panel.grid.major.x = element_line( size=.1, color=&quot;grey&quot; ),
            panel.grid.minor.x = element_line( size=.1, color=&quot;grey&quot; ),
            plot.background=element_blank(),
            plot.margin = margin(1,1, 1, 4, &quot;cm&quot;))

animacion = staticplot + transition_states(year, transition_length = 2, state_length = 4) +
      view_follow(fixed_x = TRUE)  +
      labs(title = &#39;Tasa de natalidad anual: {closest_state}&#39;)

animate(animacion, nframes=640, fps=30, width=400, height=400, res=100, detail=2)
anim_save(&quot;Natalidad regiones.gif&quot;, animation = last_animation())</code></pre>
</div>
</div>
<div id="cortar-datos-en-intervalos" class="section level4">
<h4><span class="header-section-number">2.1.0.29</span> Cortar datos en intervalos</h4>
<p><img src="DraggedImage.jpeg" /><img src="DraggedImage-1.jpeg" /></p>
<pre><code>## Plot object p
p &lt;- ggplot(diamonds, aes(x = carat, y = price))

## Use cut_interval
p + geom_boxplot(aes(group = cut_interval(carat, n=10)))

## Use cut_number
p + geom_boxplot(aes(group = cut_number(carat, n=10)))

## Use cut_width
p + geom_boxplot(aes(group = cut_width(carat, width=0.25)))</code></pre>
</div>
<div id="mapas-1" class="section level4">
<h4><span class="header-section-number">2.1.0.30</span> Mapas</h4>
<p>Graficar mapas en ggplot2</p>
<div id="graficar-mapas-de-chile" class="section level6">
<h6><span class="header-section-number">2.1.0.30.0.1</span> Graficar mapas de Chile</h6>
<p>Paquete Chilemapas
<a href="https://github.com/pachamaltese/chilemapas">https://github.com/pachamaltese/chilemapas</a></p>
</div>
<div id="recortar-mapa" class="section level6">
<h6><span class="header-section-number">2.1.0.30.0.2</span> Recortar mapa</h6>
<pre><code>mapa_cortado &lt;- st_crop(mapa, 
    xmin = -20, xmax = 45,
    ymin = 30, ymax = 73)</code></pre>
</div>
<div id="cambiar-formato-de-coordenadas" class="section level6">
<h6><span class="header-section-number">2.1.0.30.0.3</span> Cambiar formato de coordenadas</h6>
<p>Necesario cuando se usan dos mapas distintos en un solo gráfico y sus sistemas de coordenadas difieren.</p>
<p>Revisar el formato de coordenadas de los dos mapas:</p>
<pre><code>mapa1$geometry
mapa2$geometry</code></pre>
<p>Cambiar uno por el del otro:</p>
<pre><code>mapa2$geometry &lt;- st_transform(mapa2$geometry, 
    crs = 32719)</code></pre>
</div>
<div id="acercarse-a-un-mapa" class="section level6">
<h6><span class="header-section-number">2.1.0.30.0.4</span> Acercarse a un mapa</h6>
<pre><code>mapa +
coord_sf(ylim=c(-30, -10),
         xlim=c(-80, -60))</code></pre>
</div>
<div id="importar-shape" class="section level6">
<h6><span class="header-section-number">2.1.0.30.0.5</span> Importar shape</h6>
<p>El archivo .shp tiene que estar dentro de la carpeta con el resto de archivos necesarios.</p>
<pre><code>mapa &lt;- sf::st_read(&quot;Catastro_Campamentos_2019/Catastro_Campamentos_2019/Catastro_Campamentos_2019.shp&quot;)    
</code></pre>
</div>
<div id="geocodificar" class="section level6">
<h6><span class="header-section-number">2.1.0.30.0.6</span> Geocodificar</h6>
<p><a href="https://www.jessesadler.com/post/geocoding-with-r/">https://www.jessesadler.com/post/geocoding-with-r/</a></p>
</div>
</div>
</div>
<div id="figuras-y-capas" class="section level2">
<h2><span class="header-section-number">2.2</span> Figuras y capas</h2>
<p>Agregar figuras o capas extra a un gráfico</p>
<div id="agregar-capas-condicionales" class="section level4">
<h4><span class="header-section-number">2.2.0.1</span> Agregar capas condicionales</h4>
<pre><code>switch=TRUE

datos %&gt;%
ggplot(aes(x, y)) +
    {if(switch) geom_hline(yintercept = 15)}+
    geom_point()</code></pre>
<pre><code>geom_line(data = subset(afp_cotizantes2, región==&quot;Iquique&quot;), size=1) +
geom_line(data = subset(afp_cotizantes2, región!=&quot;Iquique&quot;), size=0.5, show.legend = FALSE) +</code></pre>
<p><a href="https://gist.github.com/jcheng5/3971908">https://gist.github.com/jcheng5/3971908</a></p>
</div>
<div id="agregar-barras-de-brecha" class="section level4">
<h4><span class="header-section-number">2.2.0.2</span> Agregar barras de brecha:</h4>
<pre><code>casen %&gt;%
    filter(region==&quot;Región de Tarapacá&quot;) %&gt;%
    rename(trabajan=o1) %&gt;%
    group_by(sexo, comuna, trabajan) %&gt;%
    summarise(cantidad=n()) %&gt;%
    mutate(porcentaje = cantidad/sum(cantidad)) %&gt;%
    group_by(comuna) %&gt;%
    mutate(diferencia = porcentaje[sexo == &quot;Mujer&quot;] - porcentaje) %&gt;%
    group_by(comuna, trabajan) %&gt;%
    mutate(mujer = porcentaje[sexo == &quot;Mujer&quot;]) %&gt;%
    mutate(hombre = porcentaje[sexo == &quot;Hombre&quot;]) %&gt;%
    filter(trabajan==&quot;Sí&quot;) %&gt;%
    ##filter(!is.na(trabajan)) %&gt;%
    ##graficar
    ggplot(aes(fct_reorder(str_wrap(comuna, 4), diferencia), porcentaje, fill=sexo)) +
    ##facet_wrap(~comuna, strip.position = &quot;bottom&quot;) +
    geom_col(position=&quot;dodge&quot;, width=0.8) +
    geom_text(aes(label = percent(porcentaje)), position = position_dodge2(width=0.8), 
              hjust = 1.2, vjust=0.5, size=3.5, angle=90, color=&quot;white&quot;) +
    geom_linerange(aes(ymin = mujer, ymax = hombre, linetype=&quot;Brecha\nde género&quot;), size=3, col=&quot;##DF1A57&quot;)</code></pre>
</div>
<div id="líneas-verticales-grises" class="section level4">
<h4><span class="header-section-number">2.2.0.3</span> Líneas verticales grises</h4>
<p>Agregar linea</p>
<p>Verticales:</p>
<pre><code>theme(panel.grid.major.x = element_line(color=&quot;gray90&quot;))</code></pre>
<p>Horizontales:</p>
<pre><code>theme(panel.grid.major.y = element_line(color=&quot;gray90&quot;))</code></pre>
</div>
<div id="poner-logo-en-esquina-del-gráfico" class="section level4">
<h4><span class="header-section-number">2.2.0.4</span> Poner logo en esquina del gráfico</h4>
<p>Importar logo:</p>
<pre><code>logo_tarapaca &lt;- readPNG(&quot;logo_tarapaca_2.png&quot;)</code></pre>
<pre><code>coord_cartesian(clip=&quot;off&quot;) +
annotation_custom(grob = rasterGrob(logo_tarapaca_chico, width=unit(2,&#39;cm&#39;), hjust = 7, vjust=-0.3, x = unit(1,&quot;npc&quot;), y = unit(1,&quot;npc&quot;)))</code></pre>
<p>Ajustar <code>hjust</code> y <code>vjust</code></p>
<p>Si el gráfico está horizontal:</p>
<pre><code>coord_flip(clip=&quot;off&quot;) +</code></pre>
</div>
<div id="insertar-flechas-en-el-gráfico" class="section level4">
<h4><span class="header-section-number">2.2.0.5</span> Insertar flechas en el gráfico</h4>
<pre><code>library(gridExtra)

 annotate(
        &quot;segment&quot;,
        x=dates,
        xend=dates,
        y=prices-11,
        yend=prices-1,
        color=&quot;blue&quot;,
        arrow=arrow(length=unit(0.05,&quot;npc&quot;)
        ))</code></pre>
<p>Afuera del gráfico</p>
<pre><code>annotate(&quot;segment&quot;, x=4.5, xend=3, y=-70, yend=-70, col=&quot;black&quot;, arrow=arrow(length=unit(0.3, &quot;cm&quot;))) +
scale_y_continuous(expand=c(0,0)) +
coord_cartesian(ylim = c(0, 700), clip=&quot;off&quot;) +
theme(plot.margin = unit(c(1,1,3,1), &quot;lines&quot;))</code></pre>
</div>
<div id="agregar-línea-horizontal-de-promedio" class="section level4">
<h4><span class="header-section-number">2.2.0.6</span> Agregar línea horizontal de promedio</h4>
<pre><code>geom_hline(yintercept = mean(Indcatotvalue), color=&quot;blue&quot;)</code></pre>
</div>
<div id="graficar-una-única-variable" class="section level4">
<h4><span class="header-section-number">2.2.0.7</span> Graficar una única variable</h4>
<pre><code>ggplot(mammals[mammals$vore == &quot;Insectivore&quot;, ], aes(x = sleep_total, fill = vore)) +
  geom_density(col = NA, alpha = 0.35) +
  scale_x_continuous(limits = c(0, 24)) +
  coord_cartesian(ylim = c(0, 0.3))</code></pre>
</div>
<div id="insertar-barras" class="section level4">
<h4><span class="header-section-number">2.2.0.8</span> Insertar barras</h4>
<pre><code>geom_vline
geom_hline</code></pre>
<pre><code>geom_rect(data = recess,
         aes(xmin = begin, xmax = end, ymin = -Inf, ymax = +Inf),
         inherit.aes = FALSE, fill = &quot;red&quot;, alpha = 0.2)</code></pre>
<pre><code>+ geom_vline(xintercept=0)</code></pre>
</div>
<div id="guardar-y-aplicar-capas" class="section level4">
<h4><span class="header-section-number">2.2.0.9</span> Guardar y aplicar capas</h4>
<pre><code>BMI_fill &lt;- scale_fill_brewer(&quot;BMI Category&quot;, palette = &quot;Reds&quot;)</code></pre>
<p>Luego esta capa puede aplicarse con <code>+ BMI_fill</code></p>
<p>Otro ejemplo:</p>
<pre><code>fix_strips &lt;- theme(strip.text.y = element_text(angle = 0, hjust = 0, vjust = 0.1, size = 14),
                    strip.background = element_blank(),
                    legend.position = &quot;none&quot;)

ggplot(...) + fix_strips</code></pre>
</div>
<div id="shapes" class="section level4">
<h4><span class="header-section-number">2.2.0.10</span> Shapes</h4>
<p>Las figuras <code>shape</code> de 21 a 25 tienen borde y relleno independientes.</p>
</div>
</div>
<div id="texto" class="section level2">
<h2><span class="header-section-number">2.3</span> Texto</h2>
<p>Operaciones que se pueden realizar sobre el texto de los gráficos</p>
<div id="insertar-texto-en-el-gráfico" class="section level4">
<h4><span class="header-section-number">2.3.0.1</span> Insertar texto en el gráfico</h4>
<pre><code>annotate(&quot;text&quot;, x=2.8, y=-0.025, hjust=1, col=&quot;black&quot;, label=&quot;Menores ingresos&quot;) +
annotate(&quot;text&quot;, x=8.4, y=-0.025, hjust=0, col=&quot;black&quot;, label=&quot;Mayores ingresos&quot;) +</code></pre>
<p><code>hjust = 1</code> significa que el texto se posiciona desde el borde derecho, <code>0</code> depende del borde izquierdo.</p>
<p>Para ponerlas fuera del gráfico:</p>
<pre><code>    coord_cartesian(clip = &#39;off&#39;) +
    theme(plot.margin = unit(c(1,1,3,1), &quot;lines&quot;)) + ##extender área hacia abajo</code></pre>
</div>
<div id="texto-en-barras" class="section level4">
<h4><span class="header-section-number">2.3.0.2</span> Texto en barras</h4>
<p>Crear variable que calcule el porcentaje:</p>
<pre><code>basura &lt;- basura %&gt;% ##crear variable que mide el porcenaje
    mutate(Porcentaje = (`Toneladas al año` / sum(`Toneladas al año`) * 100))</code></pre>
<pre><code>+ geom_text(aes(label = percent(Porcentaje)), 
            color=&quot;gray25&quot;, size=3, hjust = -0.2) +</code></pre>
<p>Cuando son barras stack:</p>
<pre><code>geom_text(aes(label = percent(porcentaje)), color=&quot;gray25&quot;, size=3, hjust = 0.5, vjust=0.5, position=&quot;stack&quot;) +</code></pre>
<p>Para centrar el número en las barras:</p>
<pre><code>geom_text(aes(label = percent(porcentaje)), color=&quot;gray25&quot;, size=3, hjust = 0.5, vjust=0.5, position = position_stack(vjust = 0.5)) +</code></pre>
<p>Para variables categóricas o factores:</p>
<pre><code>geom_text(aes(y = ((..count..)/sum(..count..)), 
            label = scales::percent((..count..)/sum(..count..))), 
            stat = &quot;count&quot;, hjust = -0.1, size=3, color=&quot;white&quot;) +</code></pre>
<p>porcentaje total de las barras stacked con datos tidy:</p>
<pre><code>stat_summary(fun.y = sum, aes(label = paste0(round(..y..*100, digits=1), &quot;%&quot;), group = Comuna), geom = &quot;text&quot;, vjust=-0.5, size=3, col=&quot;gray25&quot;) +</code></pre>
<p>Alternativa para pegar total</p>
<pre><code>geom_text(
        aes(label = stat(y)), 
        stat = &#39;summary&#39;, fun.y = sum, vjust = -1
    ) +</code></pre>
<p>Para barras dodge con <code>coord_flip</code></p>
<pre><code>turismo %&gt;%
    filter(!is.na(edad)) %&gt;%
    group_by(edad, genero, periodo) %&gt;%
    summarize(cantidad=n()) %&gt;%
    ggplot(aes(edad, cantidad)) +
    geom_col(aes(fill=genero), position = &quot;dodge&quot;) + 
    coord_flip() + 
    geom_text(aes(label = cantidad), position = position_dodge2(width=1), 
              size=3.5,
              hjust=-0.5) +
    facet_wrap(~periodo)</code></pre>
<p>Para permitir que el texto se salga del margen del gráfico hay que poner <code>clip = off</code> y expandir el margen del gráfico con <code>plot.margin</code>:</p>
<pre><code>coord_cartesian(clip = &#39;off&#39;) +
theme(plot.margin = unit(c(1,1,1,1),&quot;cm&quot;)) ##top right bottom left</code></pre>
</div>
<div id="mostrar-texto-en-el-gráfico-según-condición" class="section level4">
<h4><span class="header-section-number">2.3.0.3</span> Mostrar texto en el gráfico según condición</h4>
<p>Mostrar etiquetas sólo para puntos o segmentos superiores a una cantidad.
Usando <code>mutate</code>, las etiquetas que no cumplan la función quedan en blanco, manteniendo su posición:</p>
<pre><code>    ##Texto grande
    geom_text(aes(label = ifelse(Cantidad &gt; 1000, Cantidad, &quot;&quot;)), 
              position = position_dodge2(width=0.8), 
              size=3, color=&quot;red&quot;, hjust=1.2) +
    ##Texto chico
    geom_text(aes(label = ifelse(Cantidad &lt; 1000, Cantidad, &quot;&quot;)), 
              position = position_dodge2(width=0.8), 
              size=3, color=&quot;green&quot;, hjust=-0.2) +</code></pre>
<p>Poner sólo los porcentajes grandes en un gráfico de barras stacked:</p>
<pre><code>geom_text(aes(label = ifelse(Porcentaje &gt; 0.12, percent(Porcentaje, accuracy = 0.1), &quot;&quot;)), 
              ##position = position_dodge2(width=0.8),
              position = position_stack(vjust = .5),
              size=2.5, color=&quot;white&quot;) +</code></pre>
<p>Para un texto más complejo (con paste, porcentaje y frecuencia)</p>
<pre><code>    ##Texto grande
    geom_text(aes(label = ifelse(porcentaje &gt; .1, paste(percent(porcentaje, accuracy = 0.1), &quot;-&quot;, format(cantidad, big.mark=&quot;.&quot;)), &quot;&quot;)), 
              position = position_dodge2(width=0.7), 
              size=3, color=&quot;red&quot;, hjust=1.2) +
    ##Texto chico
    geom_text(aes(label = ifelse(porcentaje &lt; .1, paste(percent(porcentaje, accuracy = 0.1), &quot;-&quot;, format(cantidad, big.mark=&quot;.&quot;)), &quot;&quot;)), 
              position = position_dodge2(width=0.7), 
              size=3, color=&quot;green&quot;, hjust=-0.2) +</code></pre>
</div>
<div id="poner-valores-sobre-las-barras" class="section level4">
<h4><span class="header-section-number">2.3.0.4</span> Poner valores sobre las barras</h4>
<pre><code>geom_text(aes(label=variabley), vjust=1.5, hjust=0.5, col=&quot;white&quot;)</code></pre>
<p>Para dodge:</p>
<pre><code>geom_text(aes(label = percent(var1), 
                  y = var1 + .03), 
              position = position_dodge(0.9),
              vjust = 1)</code></pre>
<p>Si se trata de un factor:</p>
<pre><code>geom_text(stat=&#39;count&#39;, aes(label=..count..), vjust=0.5) +</code></pre>
</div>
<div id="repeler-etiquetas-de-los-puntos" class="section level4">
<h4><span class="header-section-number">2.3.0.5</span> Repeler etiquetas de los puntos</h4>
<pre><code>library(ggplot2)
library(ggrepel)

x = c(0.8846, 1.1554, 0.9317, 0.9703, 0.9053, 0.9454, 1.0146, 0.9012, 
      0.9055, 1.3307)
y = c(0.9828, 1.0329, 0.931, 1.3794, 0.9273, 0.9605, 1.0259, 0.9542, 
      0.9717, 0.9357)
z= c(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;, &quot;f&quot;, 
             &quot;g&quot;, &quot;h&quot;, &quot;i&quot;, &quot;j&quot;)


df &lt;- data.frame(x = x, y = y, z = z)
ggplot(data = df, aes(x = x, y = y)) + theme_bw() + 
geom_text_repel(aes(label = z), 
box.padding = unit(0.45, &quot;lines&quot;)) +
geom_point(colour = &quot;green&quot;, size = 3)</code></pre>
<pre><code>ggplot(dt, 
       aes(x = one, y = two, color = diff_cat)) +
  geom_point() +
  geom_text_repel(data = . %&gt;% 
                    mutate(label = ifelse(diff_cat %in% c(&quot;type_1&quot;, &quot;type_2&quot;) &amp; abs(diff) &gt; 2,
                                          name, &quot;&quot;)),
                  aes(label = label), 
                  box.padding = 1,
                  show.legend = FALSE) + ##this removes the &#39;a&#39; from the legend
  coord_cartesian(xlim = c(-5, 5), ylim = c(-5, 5)) +
  theme_bw()</code></pre>
</div>
<div id="convertir-etiquetas-a-minúscula-mayúscula-titulares-o-frase" class="section level4">
<h4><span class="header-section-number">2.3.0.6</span> Convertir etiquetas a minúscula, mayúscula, titulares, o frase</h4>
<pre><code>stringr::str_to_upper(string, locale = &quot;es&quot;)

stringr::str_to_lower(string, locale = &quot;es&quot;)

stringr::str_to_title(string, locale = &quot;es&quot;)

stringr::str_to_sentence(string, locale = &quot;es&quot;)</code></pre>
</div>
<div id="poner-suma-de-los-factores-sobre-una-barra-stacked" class="section level4">
<h4><span class="header-section-number">2.3.0.7</span> Poner suma de los factores sobre una barra stacked</h4>
<pre><code>stat_summary(fun.y = sum,                          ##pone como texto la suma de los factores en cada barra
               aes(label = ..y.., group = Año), 
               geom = &quot;text&quot;, vjust=-0.5, size=3, col=&quot;gray25&quot;) + </code></pre>
</div>
<div id="ajustar-cita-o-referencia" class="section level4">
<h4><span class="header-section-number">2.3.0.8</span> Ajustar cita o referencia</h4>
<p>Horizontalmente:</p>
<pre><code>plot.caption = element_text(hjust = 1.4)) +</code></pre>
</div>
<div id="mover-título-y-subtítulo" class="section level4">
<h4><span class="header-section-number">2.3.0.9</span> Mover título y subtítulo</h4>
<p>Horizontalmente:</p>
<pre><code>plot.title = element_text(hjust = 0.3),
plot.subtitle = element_text(hjust = 0.3),</code></pre>
</div>
<div id="buscar-y-reemplazar-palabras-de-las-etiquetas" class="section level4">
<h4><span class="header-section-number">2.3.0.10</span> Buscar y reemplazar palabras de las etiquetas</h4>
<pre><code>## buscar y reemplazar palabras para borrarlas de las etiquetas
eme2 &lt;- eme2 %&gt;% 
  mutate(tramo_ingresos = str_replace(tramo_ingresos, &quot;Entre &quot;, &quot;&quot;)) %&gt;%
  mutate(tramo_ingresos = str_replace(tramo_ingresos, &quot;y&quot;, &quot;a&quot;))</code></pre>
</div>
<div id="redondear-cifras" class="section level4">
<h4><span class="header-section-number">2.3.0.11</span> Redondear cifras</h4>
<pre><code>round(variable, digits=1)</code></pre>
<p>Ejemplo:</p>
<pre><code>geom_text(aes(label = 
                      paste0(##pegar símbolo de porcentaje
                            round(Porcentaje, digits=1),##redondear cifra
                            &quot;%&quot;)), 
              color=&quot;white&quot;, size=3.5, position=position_stack(vjust = 0.5)) +</code></pre>
</div>
<div id="pegar-signo-de-porcentaje" class="section level4">
<h4><span class="header-section-number">2.3.0.12</span> Pegar signo de porcentaje</h4>
<pre><code>paste0(Porcentaje,&quot;%&quot;)</code></pre>
<p>Ejemplo:</p>
<pre><code>geom_text(aes(label = 
                      paste0(##pegar símbolo de porcentaje
                            round(Porcentaje, digits=1),##redondear cifra
                            &quot;%&quot;)), 
              color=&quot;white&quot;, size=3.5, position=position_stack(vjust = 0.5)) +</code></pre>
</div>
<div id="cambiar-etiquetas-del-gráfico" class="section level4">
<h4><span class="header-section-number">2.3.0.13</span> Cambiar etiquetas del gráfico</h4>
<p>Cambiar títulos de los ejes</p>
<pre><code>+ labs(x=&quot;Título del eje x&quot;, y=&quot;Título del eje y&quot;)</code></pre>
<pre><code>titled_plot &lt;- initial_plot + 
    labs(title = &quot;Hell Is Other People In A Pressurized Metal Tube&quot;,
         subtitle = &quot;Percentage of 874 air-passenger respondents who said action is very or somewhat rude&quot;,
         caption = &quot;Source: SurveyMonkey Audience&quot;, 
         x = &quot;&quot;, 
         y = &quot;&quot;) </code></pre>
</div>
<div id="poner-nombre-de-barras-dentro-de-las-barras" class="section level4">
<h4><span class="header-section-number">2.3.0.14</span> Poner nombre de barras dentro de las barras</h4>
<p>Para que el texto o etiqueta del eje <code>y</code> o <code>x</code> aparezca dentro de la barra:</p>
<p>En gráficos con <code>coord_flip</code>:</p>
<pre><code>geom_text(aes(label = str_to_title(variable), y=0.02), hjust=0, size = 3.2, col=&quot;white&quot;) +
theme(axis.text.y = element_blank()) ##ocultar eje</code></pre>
<p>Sin <code>coord_flip</code>:</p>
<pre><code>geom_text(aes(label = str_to_title(variable), y=0.02), angle=90, hjust=0, size = 3.2, col=&quot;white&quot;) +
theme(axis.text.x = element_blank())</code></pre>
</div>
<div id="calcular-porcentajes" class="section level4">
<h4><span class="header-section-number">2.3.0.15</span> Calcular porcentajes</h4>
<p>Calcular porcentaje por categorías:</p>
<pre><code>group_by(gastos_forma, periodo, extranjeros) %&gt;%
    summarise(cantidad = n()) %&gt;%
    mutate(porcentaje = cantidad/sum(cantidad)) %&gt;% ##Porcentaje</code></pre>
<p>Calcular porcentaje respecto del total:</p>
<pre><code>group_by(gastos_forma, periodo, extranjeros) %&gt;%
    summarise(cantidad = n()) %&gt;%
    ungroup() %&gt;%
    mutate(porcentaje = cantidad/sum(cantidad)) %&gt;% ##Porcentaje</code></pre>
<p>Hay que agregar un <code>ungroup</code>.</p>
<p>Agregar fila con suma de totales:</p>
<pre><code>adorn_totals(&quot;row&quot;) %&gt;%</code></pre>
<p>Agregar columna con suma de totales:</p>
<pre><code>adorn_totals(&quot;col&quot;, name = &quot;Total&quot;) %&gt;%</code></pre>
</div>
<div id="poner-texto-al-final-del-gráfico-de-líneas" class="section level4">
<h4><span class="header-section-number">2.3.0.16</span> Poner texto al final del gráfico de líneas</h4>
<pre><code>    geom_text(aes(label = ifelse(Año==2018, 
                                 str_pad(number(media, accuracy = 1, big.mark=&quot;.&quot;), 20, side=&quot;right&quot;),
                                 &quot;&quot;)), 
              size=3, hjust=-0.15) +</code></pre>
<p>Puede que sea necesario mover la leyenda hacia la derecha:</p>
<pre><code>theme(legend.box.margin=margin(c(0,0,0,10))) +</code></pre>
</div>
<div id="formatear-números" class="section level4">
<h4><span class="header-section-number">2.3.0.17</span> Formatear números</h4>
<p>Quitar decimales a un número que por ejemplo es una media:</p>
<pre><code>round(Toneladas, digits = 2)</code></pre>
</div>
<div id="añadir-texto-antes-o-después-del-nombre-de-la-variable" class="section level4">
<h4><span class="header-section-number">2.3.0.18</span> Añadir texto antes o después del nombre de la variable</h4>
<pre><code>ggplot(aes(x = paste(&quot;texto&quot;, variable)))</code></pre>
<pre><code>scale_x_continuous(labels = function(x) paste(x, &quot;años&quot;),</code></pre>
</div>
<div id="formatear-una-fecha" class="section level4">
<h4><span class="header-section-number">2.3.0.19</span> Formatear una fecha</h4>
<p>Hay que tener instalado el <code>locale</code> necesario, en este caso el de español. Activar el <code>locale</code>:</p>
<pre><code>Sys.setlocale(category = &quot;LC_TIME&quot;, locale=&quot;es_ES.UTF-8&quot;) ##Meses en español</code></pre>
<p>Luego las fechas usarán meses en castellano:</p>
<pre><code>format(max(covid_comuna$Fecha), &quot;%d de %B&quot;)</code></pre>
</div>
<div id="aumentar-el-tamaño-de-todo-el-texto" class="section level4">
<h4><span class="header-section-number">2.3.0.20</span> Aumentar el tamaño de todo el texto</h4>
<pre><code>theme(text = element_text(size=16))</code></pre>
</div>
<div id="cambiar-tipografía" class="section level4">
<h4><span class="header-section-number">2.3.0.21</span> Cambiar tipografía</h4>
<pre><code>library(extrafont)

theme(plot.title = element_text(size=18, family=&quot;Bebas Kai&quot;, color=&quot;##1c2366&quot;),</code></pre>
<p>Cambiar todo el texto:</p>
<pre><code>text = element_text(family=&quot;Open Sans&quot;),</code></pre>
<p>Ver tipografías instaladas:</p>
<pre><code>extrafont::fonts()</code></pre>
</div>
<div id="cambiar-color-de-un-texto-según-condición" class="section level4">
<h4><span class="header-section-number">2.3.0.22</span> Cambiar color de un texto según condición</h4>
<p>Crear la condición necesaria y poner como categorías de la variable los colores a elegir:</p>
<pre><code>datos %&gt;%
mutate(Region2 = case_when(Region==&quot;Tarapacá&quot; ~ &quot;##red&quot;,
    TRUE ~ &quot;gray80&quot;))</code></pre>
<p>Luego agregar en el geom:</p>
<pre><code>geom_text(aes(x=Comuna, y=-50, label = Region),
    color = datos$Region2)</code></pre>
</div>
<div id="añadir-valor-o-texto-a-las-etiquetas-del-eje-x" class="section level4">
<h4><span class="header-section-number">2.3.0.23</span> Añadir valor o texto a las etiquetas del eje x</h4>
<pre><code>scale_x_discrete(labels = paste0(Region, &quot;\n&quot;, Poblacion))</code></pre>
</div>
<div id="ajustar-etiquetas-largas" class="section level4">
<h4><span class="header-section-number">2.3.0.24</span> Ajustar etiquetas largas</h4>
<p>Para cortar la categorías largas, por ejemplo, en la leyenda de un gráfico o las etiquetas de un eje:</p>
<pre><code>datos %&gt;%
  ggplot(aes(variable, str_wrap(variable, width = 35))) +
  geom_line()</code></pre>
<p>Donde el número es los caracteres del ancho de línea.</p>
<p>Para aplicar desde fuera:</p>
<pre><code>scale_x_discrete(labels = function(x) str_wrap(x, width = 10))</code></pre>
<p>Para mantener el orden de los factores:</p>
<pre><code>str_wrap_factor &lt;- function(x, ...) {
    levels(x) &lt;- str_wrap(levels(x), ...)
    x
}</code></pre>
<p>Y luego usar <code>str_wrap_factor</code> del mismo modo que <code>str_wrap</code></p>
<p>Cortar factores:</p>
<pre><code>mutate(ocupación_CIUO = str_trunc(as.character(ocupación_CIUO), 30, side=&quot;right&quot;)) %&gt;%</code></pre>
<p>Luego volver a convertir a factor.</p>
</div>
<div id="ggtext" class="section level4">
<h4><span class="header-section-number">2.3.0.25</span> ggtext</h4>
<p><a href="https://thomasadventure.blog/posts/enhance-ggplot2-with-ggtext/">Enhance Your ggplot2 Data Visualizations with ggtext</a></p>
</div>
</div>
<div id="escalas" class="section level2">
<h2><span class="header-section-number">2.4</span> Escalas</h2>
<p>Manipulación de las escalas de los gráficos, que son los elementos que controlan la disposición espacial de las observaciones en el plano.</p>
<div id="ordenar-grafico-de-barras" class="section level4">
<h4><span class="header-section-number">2.4.0.1</span> Ordenar grafico de barras</h4>
<p>Ordenar las barras para que una categoría del stack vaya de mayor a menor: crear una variable con <code>case_when</code> que sea un valor numérico, luego sumar esos valores numéricos en <code>summarize</code> según los grupos.</p>
<pre><code>turismo2 %&gt;%
  mutate(orden = case_when(interés == &quot;Es de interes&quot; ~ &quot;1&quot;, TRUE ~ &quot;0&quot;)) %&gt;%
  mutate(orden = as.numeric(orden)) %&gt;%
  group_by(ubicación, interés, orden) %&gt;%
  summarize(cantidad = n(),
            orden2 = sum(orden)) %&gt;%
    ggplot(aes(fct_reorder(ubicación, orden2), porcentaje, fill=interés))</code></pre>
<p>Alternativa: crear variable de orden con un subset</p>
<pre><code>group_by(Region) %&gt;%
  mutate(Orden = Valor[Grupo == &quot;Casos&quot;]) %&gt;%
  ggplot(aes(fct_reorder(Region, Orden), 
             Valor, fill = Grupo)) +</code></pre>
</div>
<div id="expandir-un-eje" class="section level4">
<h4><span class="header-section-number">2.4.0.2</span> Expandir un eje</h4>
<p>Por ejemplo, si una línea queda muy corta en la parte superior de un gráfico de densidad. Similar a <code>coord_cartesian</code></p>
<pre><code>scale_y_discrete(expand = expand_scale(add = c(0.3, 5.5))) +</code></pre>
</div>
<div id="poner-comas-en-los-ejes" class="section level4">
<h4><span class="header-section-number">2.4.0.3</span> Poner comas en los ejes</h4>
<pre><code>scale_x_continuous(labels = scales::comma)</code></pre>
</div>
<div id="intercambiar-ejes" class="section level4">
<h4><span class="header-section-number">2.4.0.4</span> Intercambiar ejes</h4>
<pre><code>+ coord_flip()</code></pre>
<p>Intercambiar y cortar o extender:</p>
<pre><code>coord_flip(xlim=c(0, 800)) + </code></pre>
</div>
<div id="cambiar-orden-de-los-ejes" class="section level4">
<h4><span class="header-section-number">2.4.0.5</span> Cambiar orden de los ejes</h4>
<pre><code>ggplot(aes(x = logFoldChange, y = reorder(variable, variable_de_ordenamiento)) +
    geom_point()</code></pre>
<p>Invertir el orden:</p>
<pre><code>ggplot(datos, aes(x=fct_rev(var1), y=...))</code></pre>
<p>Reordenar ascendente:</p>
<pre><code>ggplot(datos, aes(x = fct_infreq(var1), y=...</code></pre>
<p>Reordenar descendente</p>
<pre><code>ggplot(datos, aes(x = fct_rev(fct_infreq(variable))))</code></pre>
<p>Reordenar según otra variable</p>
<pre><code>ggplot(datos, aes(x= fct_reorder(variable, referencia), y=...</code></pre>
<p>Según otra pero en descendiente:</p>
<pre><code>mutate(Genre = fct_reorder(Genre, n, .desc = TRUE))</code></pre>
<p>Reordenar manualmente:</p>
<pre><code>name = factor(name, levels=c(&quot;north&quot;, &quot;north-east&quot;, &quot;east&quot;, &quot;south-east&quot;, &quot;south&quot;, &quot;south-west&quot;, &quot;west&quot;, &quot;north-west&quot;)))</code></pre>
<p>Reordenar según suma de los valores del eje:</p>
<pre><code>  ggplot(aes(x=fct_reorder(Comuna, Porcentaje, .fun=sum, .desc=TRUE)</code></pre>
<p>Util cuando son barras stacked y hay que ordenar por la suma de los factores</p>
</div>
<div id="girar-etiquetas-del-eje-x" class="section level4">
<h4><span class="header-section-number">2.4.0.6</span> Girar etiquetas del eje x</h4>
<p>Girar etiquetas del eje, dándole ángulo o poniéndola horizontal, por ejemplo</p>
<pre><code>axis.text.x = element_text(angle = -90, hjust=0)) +</code></pre>
<p><code>hjust</code> justifica el texto</p>
<p>Girar a la derecha y justificar:</p>
<pre><code>theme(axis.text.x = element_text(hjust=0, vjust=0.5, angle = -90)</code></pre>
</div>
<div id="cambiar-márgenes-de-elementos" class="section level4">
<h4><span class="header-section-number">2.4.0.7</span> Cambiar márgenes de elementos</h4>
<pre><code>theme(axis.text.x = element_text(margin = margin(t = 0)),
    axis.text.y = element_text(margin = margin(r = -5)),
    plot.subtitle = element_text(margin = margin(b = 15)))</code></pre>
</div>
<div id="mostrar-todas-las-etiquetas-del-eje-x" class="section level4">
<h4><span class="header-section-number">2.4.0.8</span> Mostrar todas las etiquetas del eje x</h4>
<p>Mostrar todas las etiquetas del eje x</p>
<pre><code>scale_x_continuous(&quot;ID&quot;, labels = as.character(ID), breaks = ID)</code></pre>
<pre><code>scale_x_continuous(breaks = c(1973:1980))</code></pre>
</div>
<div id="definir-cortes-del-eje-y" class="section level4">
<h4><span class="header-section-number">2.4.0.9</span> Definir cortes del eje y</h4>
<pre><code>scale_y_continuous(breaks = c(10, 50, 100, 150, 200)) +</code></pre>
<p>También sirve para eliminar el 0 del eje. Para combinar con logaritmo: <code>, trans="log10"</code></p>
</div>
<div id="transformar-escalas-a-logaritmo" class="section level4">
<h4><span class="header-section-number">2.4.0.10</span> Transformar escalas a logaritmo</h4>
<pre><code>## Transform the scale
d + scale_y_log10()
</code></pre>
<pre><code>## Transform the coordinates
d + coord_trans(y=&quot;log10&quot;)</code></pre>
</div>
<div id="agregar-alfombra" class="section level4">
<h4><span class="header-section-number">2.4.0.11</span> Agregar alfombra</h4>
<p>Muestra los puntos exactos donde existen datos.</p>
<p><code>+ geom_rug()</code></p>
</div>
<div id="cambiar-eje-a-logaritmo" class="section level4">
<h4><span class="header-section-number">2.4.0.12</span> Cambiar eje a logaritmo</h4>
<p>Para cambiar una escala a logarítmica:</p>
<pre><code>+ scale_x_log10()</code></pre>
</div>
<div id="ampliar-eje" class="section level4">
<h4><span class="header-section-number">2.4.0.13</span> Ampliar eje</h4>
<p>Para que un eje empiece desde cero y así se elimine el margen o espaciado por defecto de ggplot:</p>
<pre><code>expand_limits(y=0)</code></pre>
<pre><code>coord_flip(expand=FALSE)</code></pre>
<pre><code>scale_x_discrete(expand = c(0, 0)) +</code></pre>
<pre><code>scale_x_continuous(expand = c(0, 0)) + scale_y_continuous(expand = c(0, 0))</code></pre>
</div>
<div id="insertar-un-nivel-en-blanco-para-una-escala" class="section level4">
<h4><span class="header-section-number">2.4.0.14</span> Insertar un nivel en blanco para una escala</h4>
<p>Para que en la leyenda aparezca un espacio vacío entremedio.</p>
<p>Primero agregar el nivel blanco con <code>\n</code>:</p>
<pre><code>previsión_t$previsión = factor(previsión_t$previsión, levels=c(&quot;Fonasa A&quot;, &quot;Fonasa B&quot;, &quot;Fonasa C&quot;, &quot;Fonasa D&quot;, &quot;Fonasa desconocido&quot;, &quot;\n\n&quot;,&quot;Isapre&quot;, &quot;FF.AA. y de Orden&quot;, &quot;Ninguno (Particular)&quot;, &quot;Otro sistema&quot;))  </code></pre>
<p>Luego definir el color blanco y determinar que no se salte el nivel al estar vacío.</p>
<pre><code>scale_fill_manual(values = c(degradado1(4), &quot;gray70&quot;,
                                 &quot;white&quot;, ##Color del nivel en blanco
                                 degradado4(3), &quot;gray70&quot;),
                       drop = FALSE) + ##Determinar que el nivel en blanco no se salte</code></pre>
</div>
<div id="escalas-de-series-de-tiempo" class="section level4">
<h4><span class="header-section-number">2.4.0.15</span> Escalas de series de tiempo</h4>
<p><a href="https://www.statworx.com/at/blog/customizing-time-and-date-scales-in-ggplot2/">https://www.statworx.com/at/blog/customizing-time-and-date-scales-in-ggplot2/</a></p>
<p>Configurar el eje x cuando es fecha:</p>
<pre><code>scale_x_date(breaks = seq(from = ymd(&#39;2020-03-30&#39;), to = max(covid_comuna$Fecha), 
                            ##by=1),
                            length.out=12),
               date_labels = &quot;%d/%B&quot;) +</code></pre>
<p>La opción <code>by=1</code> pone un break por fecha, y <code>length.out</code> pone la cantidad de breaks definidos, dispersados entre el menos y el mayor.</p>
</div>
<div id="cambiar-escalas-continuas" class="section level4">
<h4><span class="header-section-number">2.4.0.16</span> Cambiar escalas continuas</h4>
<pre><code>    scale_fill_viridis(option=&quot;magma&quot;, ##color
                       name = &quot;Porcentaje \nde votantes&quot;, 
                       breaks = c(0, 25, 50, 75, 100),
                       labels=c(&quot;0%&quot;, &quot;25%&quot;, &quot;50%&quot;, &quot;75%&quot;, &quot;100%&quot;),
                       limits=c(20,80)) +</code></pre>
</div>
<div id="escalas-1" class="section level4">
<h4><span class="header-section-number">2.4.0.17</span> Escalas</h4>
<p>Cambiar el rango de tamaños de los puntos</p>
<pre><code>+ scale_size(range = c(1, 10))</code></pre>
<p>Etiquetas en la escala manualmente:</p>
<pre><code>scale_y_continuous(breaks = c(300000, 1000000,5000000,10000000))</code></pre>
<p>Etiquetas menores en la escala:</p>
<pre><code>scale_x_continuous(breaks = c(1990, 1995, 2000, 2005, 2010, 2014, 2017),
                       minor_breaks = seq(1991, 2016, 1)) +</code></pre>
<p>Secuencia de breaks en la escala:</p>
<pre><code>scale_y_continuous(limits = c(0, 12000), breaks = seq(0,12000,by = 2000)</code></pre>
</div>
<div id="escala-en-miles" class="section level4">
<h4><span class="header-section-number">2.4.0.18</span> Escala en miles</h4>
<p>Puntos de miles en la escala:</p>
<pre><code>scale_y_continuous(labels = function(x) format(x, big.mark = &quot;.&quot;)) +</code></pre>
<p>Escala de miles</p>
<p>O bien:</p>
<pre><code>scale_size_continuous(labels = scales::number) +</code></pre>
</div>
<div id="escala-en-porcentajes" class="section level4">
<h4><span class="header-section-number">2.4.0.19</span> Escala en porcentajes</h4>
<pre><code>library(scales)

scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +</code></pre>
<p>Pegar porcentaje en eje (si los valores ya vienen multiplicados por 100:</p>
<pre><code>scale_y_continuous(labels = function(x) paste0(x, &quot;%&quot;)) +</code></pre>
</div>
</div>
<div id="colores" class="section level2">
<h2><span class="header-section-number">2.5</span> Colores</h2>
<p>Operaciones que permiten controlar y modificar los colores utilizados en los gráficos.</p>
<div id="agregar-más-de-una-escala-de-color" class="section level4">
<h4><span class="header-section-number">2.5.0.1</span> Agregar más de una escala de color</h4>
<p><a href="https://eliocamp.github.io/ggnewscale/">https://eliocamp.github.io/ggnewscale/</a></p>
</div>
<div id="escalas-continuas-de-colores-degradado" class="section level4">
<h4><span class="header-section-number">2.5.0.2</span> Escalas continuas de colores (degradado)</h4>
<p>Definir color del mínimo y máximo:</p>
<pre><code>scale_fill_gradient(low = &quot;gray90&quot;, high = color_verde) +</code></pre>
<p>Definir color del mínimo, intermedio y máximo:</p>
<pre><code>scale_color_gradient2(low = colorspace::darken(color_verde, 0.2), 
                            mid = colorspace::darken(color_verde, 0.4), 
                            high = &quot;white&quot;, 
                            midpoint = 3.8) +</code></pre>
<p>Opcionalmente, definir en <code>midpoint</code> el punto que equivale al intermedio.</p>
</div>
<div id="aplicar-paleta-de-colores-específicas-a-determinadas-variables" class="section level4">
<h4><span class="header-section-number">2.5.0.3</span> Aplicar paleta de colores específicas a determinadas variables</h4>
<pre><code>cyl &lt;- sort(unique(mpg$cyl))
ncat &lt;- length(cyl)          ## 4 types of cylinders

## create palettes
library(RColorBrewer)
purples &lt;- tibble(cyl, colr = brewer.pal(ncat, &quot;Purples&quot;))
reds    &lt;- tibble(manufacturer = &quot;audi&quot;, cyl, colr = brewer.pal(ncat, &quot;Reds&quot;))
blues   &lt;- tibble(manufacturer = &quot;ford&quot;, cyl, colr = brewer.pal(ncat, &quot;Blues&quot;))

## merge them with the data
dd_p &lt;- dd %&gt;% filter(!(manufacturer %in% c(&quot;audi&quot;, &quot;ford&quot;))) %&gt;% left_join(purples)
dd_r &lt;- dd %&gt;% filter(manufacturer == &quot;audi&quot;) %&gt;% left_join(reds)
dd_b &lt;- dd %&gt;% filter(manufacturer == &quot;ford&quot;) %&gt;% left_join(blues)

gg_dd &lt;- rbind(dd_p, dd_r, dd_b) %&gt;%
        left_join(mm)

gg_dd %&gt;% 
        ggplot(mapping = aes(x = reorder(manufacturer, mcyl), y = n, fill = colr)) + 
        geom_bar(stat = &quot;identity&quot;, position = &quot;fill&quot;) +
        coord_flip() +
        scale_fill_identity() </code></pre>
</div>
<div id="aplicar-escala-de-color-automática" class="section level4">
<h4><span class="header-section-number">2.5.0.4</span> Aplicar escala de color automática</h4>
<p>Primero crear la escala de color con tantos colores como se necesiten:</p>
<pre><code>degradado &lt;- colorRampPalette(c(&quot;##DF1A57&quot;, &quot;##AF87EB&quot;, &quot;##1D3284&quot;))</code></pre>
<p>Luego aplicar la escala al gráfico, determinando el número de colores a usar:</p>
<pre><code>scale_color_manual(values = degradado(7),
aesthetics = c(&quot;fill&quot;, &quot;col&quot;)) +</code></pre>
</div>
<div id="crear-escala-o-degradado-de-colores" class="section level4">
<h4><span class="header-section-number">2.5.0.5</span> Crear escala o degradado de colores</h4>
<pre><code>degradado &lt;- colorRampPalette(c(&quot;##DF1A57&quot;, &quot;##c444c4&quot;, &quot;##6739b2&quot;, &quot;##1D3284&quot;), bias=0.9)</code></pre>
<p>Bias es la separación de los colores en los extremos de la escala. Un bias alto (mayor a 1) hace que los colores cambien más rápido y uno bajo (cercano a 0) distribuye los colores más suavemente.</p>
</div>
<div id="previsualizar-colores" class="section level4">
<h4><span class="header-section-number">2.5.0.6</span> Previsualizar colores</h4>
<p>Para ver un color o vector de colores:</p>
<pre><code>scales::show_col(&quot;##DF1A57&quot;)

scales::show_col(c(&quot;##DF1A57&quot;, &quot;##c444c4&quot;, &quot;##6739b2&quot;, &quot;##1D3284&quot;))

scales::show_col(degradado7b(7))</code></pre>
</div>
<div id="aclarar-u-oscurecer-colores" class="section level4">
<h4><span class="header-section-number">2.5.0.7</span> Aclarar u oscurecer colores</h4>
<pre><code>colorspace::lighten(&quot;red&quot;, amount = 0.5)</code></pre>
<pre><code>scales::show_col(colorspace::lighten(color_naranjo, amount = 0.6))</code></pre>
</div>
<div id="rcolorbrewer" class="section level4">
<h4><span class="header-section-number">2.5.0.8</span> RColorBrewer</h4>
<pre><code>scale_fill_brewer(palette = &quot;Dark2&quot;) +</code></pre>
<p>Para ver todas las paletas disponibles:</p>
<pre><code>RColorBrewer::display.brewer.all()</code></pre>
<p>Extraer colores:</p>
<pre><code>colores_presidencial &lt;- rev(brewer.pal(9, &#39;YlGnBu&#39;)) ##extraer paleta de colores</code></pre>
<p>Luego aplicar como gradiente:</p>
<pre><code>scale_fill_gradientn(colours = colores_presidencial, ##crear gradiente de colores
                         name = &quot;Porcentaje \nde votantes&quot;, 
                         breaks = c(10, 30, 50, 70, 90)) + </code></pre>
</div>
<div id="crear-degradados-de-color" class="section level4">
<h4><span class="header-section-number">2.5.0.9</span> Crear degradados de color</h4>
<p>Crear escala de colores entre colores específicos:</p>
<pre><code>degradado1 &lt;- colorRampPalette(c(&quot;##DF1A57&quot;, &quot;##AF87EB&quot;, &quot;##1D3284&quot;))</code></pre>
<p>Luego aplicar así:</p>
<pre><code>scale_color_manual(values = degradado1(5)) +</code></pre>
<p>Donde el número es la cantidad de colores</p>
</div>
<div id="extender-escalas-de-colores" class="section level4">
<h4><span class="header-section-number">2.5.0.10</span> Extender escalas de colores</h4>
<pre><code>## Definition of a set of blue colors
blues &lt;- brewer.pal(9, &quot;Blues&quot;) ## from the RColorBrewer package

## 1 - Make a color range using colorRampPalette() and the set of blues
blue_range &lt;- colorRampPalette(blues)

## 2 - Use blue_range to adjust the color of the bars, use scale_fill_manual()
ggplot(Vocab, aes(x = education, fill = vocabulary)) +
  geom_bar(position = &quot;fill&quot;) +
  scale_fill_manual(values=blue_range(11))</code></pre>
</div>
<div id="determinar-colores-para-variable-categórica" class="section level4">
<h4><span class="header-section-number">2.5.0.11</span> Determinar colores para variable categórica</h4>
<pre><code>colores_redes&lt;- c(&quot;Facebook&quot;=&quot;##1877f2&quot;,&quot;WhatsApp y similares&quot;=&quot;##25d366&quot;,&quot;Instagram&quot;=&quot;##c32aa3&quot;,&quot;Skype&quot;=&quot;##00aff0&quot;,&quot;Twitter&quot;=&quot;##1da1f2&quot;,&quot;Tinder y similares&quot;=&quot;##FF5864&quot;,&quot;Snapchat&quot;=&quot;##fffc00&quot;,&quot;LinkedIn&quot;=&quot;##007bb5&quot;)</code></pre>
<p>Luego, dependiendo del tipo del elemento:</p>
<pre><code>scale_fill_manual(values = colores_redes) + 
scale_color_manual(values = colores_redes) +</code></pre>
</div>
<div id="más-escalas-de-colores" class="section level4">
<h4><span class="header-section-number">2.5.0.12</span> Más escalas de colores</h4>
<div id="viridis" class="section level6">
<h6><span class="header-section-number">2.5.0.12.0.1</span> Viridis</h6>
<pre><code>scale_color_viridis() +</code></pre>
<pre><code>scale_fill_viridis(option=&quot;magma&quot;) +</code></pre>
<p>“magma”, “plasma”, and “inferno.”</p>
<pre><code>discrete = TRUE</code></pre>
<p>Más paletas:
- <a href="https://twitter.com/wearerladies/status/1180545410974257152?s=12">https://twitter.com/wearerladies/status/1180545410974257152?s=12</a>
- <a href="https://github.com/EmilHvitfeldt/r-color-palettes/blob/master/type-sorted-palettes.md##qualitative-color-palettes">https://github.com/EmilHvitfeldt/r-color-palettes/blob/master/type-sorted-palettes.md##qualitative-color-palettes</a></p>
</div>
<div id="cartocolor" class="section level6">
<h6><span class="header-section-number">2.5.0.12.0.2</span> CartoColor</h6>
<p><a href="https://github.com/Nowosad/rcartocolor">https://github.com/Nowosad/rcartocolor</a>
Ver colores:</p>
<pre><code>cartocolor::display_carto_all()</code></pre>
<p>Usar:</p>
<pre><code>scale_fill_carto_c(name = &quot;Life expectancy: &quot;, type = &quot;diverging&quot;, palette = &quot;Earth&quot;, direction = -1)</code></pre>
</div>
<div id="scico" class="section level6">
<h6><span class="header-section-number">2.5.0.12.0.3</span> Scico</h6>
<p>Ver colores:</p>
<pre><code>scico::scico_palette_show()</code></pre>
<p>Generar paleta:</p>
<pre><code>paleta &lt;- scico::scico(30, palette = &#39;lapaz&#39;)</code></pre>
<p>Usar escala:</p>
<pre><code>ggplot(volcano, aes(x = x, y = y, fill = height)) + 
  geom_raster() + 
  scale_fill_scico(palette = &#39;davos&#39;) </code></pre>
</div>
<div id="fishualize" class="section level6">
<h6><span class="header-section-number">2.5.0.12.0.4</span> Fishualize</h6>
<pre><code>devtools::install_github(&quot;nschiett/fishualize&quot;, force = TRUE)
library(fishualize)

paleta &lt;- fish(10, option = &quot;Ostracion_cubicus&quot;)</code></pre>
<p>Ver colores:
<a href="https://nschiett.github.io/fishualize/articles/overview_colors.html">https://nschiett.github.io/fishualize/articles/overview_colors.html</a></p>
<pre><code>scales::show_col(fishualize::fish(10, option = &quot;Antennarius_commerson&quot;))</code></pre>
<p>Bonitas:</p>
<pre><code>Oncorhynchus_tshawytscha
Bodianus_pulchellus
Antennarius_commerson</code></pre>
<pre><code>scales::show_col(fishualize::fish(10, option = &quot;Oncorhynchus_keta&quot;))</code></pre>
<p>Ver lista de peces:</p>
<pre><code>spp &lt;- fishualize::fish_palettes()</code></pre>
<pre><code>##Escalas continuas:
scale_color_fish(option = &quot;Hypsypops_rubicundus&quot;, direction = -1)

##Escalas discretas:
scale_color_fishd(option = &quot;Hypsypops_rubicundus&quot;, direction = -1)

scale_color_fish(option = &quot;Coris_gaimard&quot;, discrete = TRUE)</code></pre>
</div>
<div id="ghibli" class="section level6">
<h6><span class="header-section-number">2.5.0.12.0.5</span> Ghibli</h6>
<p><a href="https://ewenme.github.io/ghibli/index.html">https://ewenme.github.io/ghibli/index.html</a><img src="https://ewenme.github.io/ghibli/reference/figures/README-palettes-1.png" /></p>
<pre><code>library(ghibli)
scale_colour_ghibli_d(&quot;LaputaMedium&quot;, direction = -1)</code></pre>
</div>
<div id="paletter" class="section level6">
<h6><span class="header-section-number">2.5.0.12.0.6</span> PaletteR</h6>
<pre><code>devtools::install_github(&quot;AndreaCirilloAC/paletter&quot;)

library(paletter)

image_path &lt;- &quot;path_to_your_image&quot;
colours_vector &lt;- create_palette(image_path = image_path,
number_of_colors =32,
type_of_variable = “categorical&quot;)

ggplot(data = mtcars, aes(x = rownames(mtcars),y = hp,color = rownames(mtcars),
                          fill = rownames(mtcars))) +
  geom_bar(stat = &#39;identity&#39;) +
  scale_color_manual(values = colours_vector) +
  scale_fill_manual(values=colours_vector)+</code></pre>
</div>
<div id="pirate-palette" class="section level6">
<h6><span class="header-section-number">2.5.0.12.0.7</span> Pirate palette</h6>
<pre><code>yarrr::piratepal(palette = &quot;all&quot;)</code></pre>
</div>
</div>
</div>
<div id="leyendas" class="section level2">
<h2><span class="header-section-number">2.6</span> Leyendas</h2>
<p>Manipular la leyenda, o la sección del gráfico que contiene los colores y/o etiquetas de los elementos gráficos que lo componen.</p>
<div id="crear-gráfico-con-leyenda-manual" class="section level4">
<h4><span class="header-section-number">2.6.0.1</span> Crear gráfico con leyenda manual</h4>
<p>Cuando los elementos el gráfico se hacen por capas separadas y por lo tanto no aparecen con leyenda:</p>
<pre><code>cols &lt;- c(&quot;Investigadores\nhombres&quot;=&quot;##B077E5&quot;,
          &quot;Investigadoras\nmujeres&quot;=&quot;##DF1A57&quot;,
          &quot;Total de\ninvestigadores&quot;=&quot;##1D3284&quot;)

investigadores %&gt;%
  rename(año=1) %&gt;%
  ##pivot_longer(cols=c(3:4), names_to=&quot;género&quot;, values_to=&quot;valor&quot;) %&gt;%
  ggplot(aes(año)) +
  geom_col(aes(y=total, fill=&quot;Total de\ninvestigadores&quot;)) +
  geom_line(aes(y=mujeres, col=&quot;Investigadoras\nmujeres&quot;), size=2, alpha=0.6) +
  geom_point(aes(y=mujeres, col=&quot;Investigadoras\nmujeres&quot;), size=4) +
  geom_line(aes(y=hombres, col=&quot;Investigadores\nhombres&quot;), size=2, alpha=0.6) +
  geom_point(aes(y=hombres, col=&quot;Investigadores\nhombres&quot;), size=4) +
  ##texto
  geom_text(aes(y= mujeres-3.5, label = mujeres), col=&quot;white&quot;) +
  geom_text(aes(y= hombres+3.5, label = ifelse(año!=2013, hombres, &quot;&quot;)), col=&quot;white&quot;) +
  geom_text(aes(y= hombres+5.5, label = ifelse(año==2013, hombres, &quot;&quot;)), col=&quot;white&quot;) +
  geom_text(aes(y= total+3, label = total)) +
  ##escalas
  scale_colour_manual(name=&quot;Error Bars&quot;, values = cols) + 
  scale_fill_manual(name=&quot;Bar&quot;, values = cols) +
  scale_x_continuous(breaks=c(2009:2017)) +
  labs(y=&quot;Cantidad de investigadores/as&quot;)</code></pre>
<p>Alternativa más rápida:</p>
<pre><code>geom_hline(aes(yintercept = promedio, col=&quot;Arancel promedio&quot;)) +
scale_colour_manual(name=&quot;Error Bars&quot;, values = c(&quot;Arancel promedio&quot;=&quot;red&quot;)) + </code></pre>
</div>
<div id="invertir-orden-de-leyenda" class="section level4">
<h4><span class="header-section-number">2.6.0.2</span> Invertir orden de leyenda</h4>
<pre><code>guides(fill = guide_legend(reverse = TRUE)) +</code></pre>
</div>
<div id="orientación-y-ubicación-de-la-leyenda" class="section level4">
<h4><span class="header-section-number">2.6.0.3</span> Orientación y ubicación de la leyenda</h4>
<p>Ubicación de la leyenda: <code>theme(legend.position = c(0.85, 0.85))</code></p>
<p>Mover la leyenda en relación a su ubicación por defecto:</p>
<pre><code>legend.box.margin=margin(c(0,0,0,-60)) ##moverla a la izquierda</code></pre>
<p>Leyenda dentro del gráfico:</p>
<pre><code>theme(legend.position = c(.8,.8))</code></pre>
<p>Eliminar leyenda: <code>theme(legend.position = "none")</code></p>
<p>Añadir margen al gráfico:</p>
<pre><code>theme(panel.spacing.x=unit(2, &quot;cm&quot;), plot.margin=unit(c(1,2,1,1), &quot;cm&quot;))</code></pre>
<p>Eliminar todos los rectángulos: <code>no_panels &lt;- theme(rect = element_blank())</code></p>
<p>Poner leyenda abajo:</p>
<pre><code>theme(legend.position = &quot;bottom&quot;)</code></pre>
<p>Cambiar orientación de los elementos de la leyenda:</p>
<pre><code>theme(legend.direction = &quot;horizontal&quot;)</code></pre>
<p>Cambiar ubicación de leyenda:</p>
<pre><code>+ theme(legend.position = &quot;bottom&quot;,
          legend.box = &quot;vertical&quot;) </code></pre>
</div>
<div id="textos-de-leyenda" class="section level4">
<h4><span class="header-section-number">2.6.0.4</span> Textos de leyenda</h4>
<p>Cambiar título de leyenda:</p>
<pre><code>+ scale_fill_discrete(name = &quot;&quot;)</code></pre>
<p>Si es una combinación de geoms:</p>
<pre><code>labs(fill = &quot;Nacionalidad&quot;, col = &quot;Nacionalidad&quot;) +</code></pre>
<p>Cambiar nombre de elementos de la leyenda:</p>
<pre><code>+ scale_fill_discrete(name = &quot;Padrón electoral&quot;, labels = c(&quot;Inscritos que no votaron&quot;, &quot;Votantes&quot;)) +</code></pre>
<p>Ocultar una leyenda específica:</p>
<pre><code>+ guides(col = FALSE)</code></pre>
<p>O poner dentro del geom: <code>show.legend=FALSE</code></p>
</div>
<div id="elementos-de-la-leyenda" class="section level4">
<h4><span class="header-section-number">2.6.0.5</span> Elementos de la leyenda</h4>
<p>Cambiar espaciado horizontal de leyenda:</p>
<pre><code>legend.spacing.x = unit(0.4, &#39;cm&#39;) ##NO SIRVE?</code></pre>
<p>Cambiar espaciado vertical de elementos de leyenda:</p>
<pre><code>legend.text = element_text(margin = margin(t=4, b = 4), size=9))</code></pre>
<p>Tamaño de cuadrados de leyenda</p>
<pre><code>legend.key.size = unit(1.7, &#39;lines&#39;)</code></pre>
<p>Ajustar espacio vertical:</p>
<pre><code>legend.text = element_text(margin = margin(t=10, b=10)),</code></pre>
<p>Ajustar espaciado de leyendas:</p>
<pre><code>legend.text = element_text(margin = margin(l = -2, r = 10), size=8))</code></pre>
<p>Definir cantidad de filas en que aparecen las leyendas:</p>
<pre><code>guides(fill = guide_legend(nrow = 3)) + ##cantidad de filas de la leyenda</code></pre>
<p>Invertir elementos de leyenda:</p>
<pre><code>guides(fill = guide_legend(reverse = TRUE))</code></pre>
<p>Cambiar forma de la leyenda:</p>
<pre><code>guides(colour = guide_legend(override.aes = list(shape = 15)))</code></pre>
<p>Borrar el cuadrado gris de fondo de la leyenda:</p>
<pre><code>theme(legend.key = element_blank())</code></pre>
<p>Cambiar color de la leyenda:</p>
<pre><code>guides(shape = guide_legend(override.aes = list(colour = &quot;pink&quot;)))</code></pre>
</div>
<div id="margen-de-la-leyenda" class="section level4">
<h4><span class="header-section-number">2.6.0.6</span> Margen de la leyenda</h4>
<pre><code>theme(legend.margin = margin(20, 20, 20, 0)) + ##caja de la leyenda</code></pre>
</div>
<div id="leyendas-redondas" class="section level4">
<h4><span class="header-section-number">2.6.0.7</span> Leyendas redondas</h4>
<p>Cambiar una leyenda redonda de <code>geom_line</code> o <code>geom_point</code> por una cuadrada como de <code>geom_col</code></p>
<pre><code>guides(col = guide_legend(nrow = 3, override.aes = list(shape = 15, size=7))) +</code></pre>
<p>Para que las barras tengan círculos en la leyenda:
- poner fill y col en aes()
- poner un <code>geom_point</code> de size 0, alpha 0
- show-legend F en las columnas
- que los títulos coincidan en labs, y que se use o no reverse en guides de forma consistente:</p>
<pre><code>theme(legend.key = element_blank(),
        legend.background = element_blank()) +
  geom_point(size=0) +
  ##guides(fill = guide_legend(override.aes = list(fill = NA, text = NA, alpha = 1))) +
  guides(col = guide_legend(reverse = TRUE,
                            override.aes = list(size=5, fill=NA, text=NA)))</code></pre>
<p>Ejemplo en gráfico de líneas</p>
<pre><code>ggplot(aes(fecha, valor, col=parque, fill=parque)) +
  geom_line(show.legend = FALSE) +
  geom_point(size=0, alpha=0) +
  scale_y_continuous(labels = function(x) format(x, big.mark = &quot;.&quot;)) +
  labs(y=&quot;Visitas&quot;) +
  theme_minimal() +
  theme(legend.position = &quot;bottom&quot;,
        legend.title = element_blank(),
        axis.title.x = element_blank(),
        legend.text = element_text(margin = margin(t=3, b=3, r=6))) +
  guides(col = guide_legend(ncol=2,
                            override.aes = list(size=4, fill=NA, text=NA))) +
  guides(fill = guide_legend(override.aes = list(fill = NA, text = NA, alpha = 1)))</code></pre>
</div>
</div>
<div id="temas-y-espaciado" class="section level2">
<h2><span class="header-section-number">2.7</span> Temas y espaciado</h2>
<div id="espaciado-entre-facetas" class="section level4">
<h4><span class="header-section-number">2.7.0.1</span> Espaciado entre facetas</h4>
<p>El espacio horizontal entre dos facetas de un gráfico, cuando el gráfico se separa en facetas con <code>facet_wrap()</code></p>
<pre><code>theme(panel.spacing.x=unit(2, &quot;cm&quot;))</code></pre>
</div>
<div id="reducir-margen-de-gráficos" class="section level4">
<h4><span class="header-section-number">2.7.0.2</span> Reducir margen de gráficos</h4>
<p>Especialmente útil para gráficos de torta</p>
<pre><code>theme(plot.margin = margin(-20, 0, -20, -0)) +</code></pre>
<p>Ejemplo:</p>
<pre><code>plot.margin = margin(20, ##arriba
                               -90, ##derecha
                               10, ##abajo
                               -50) ##izquierda
          )</code></pre>
</div>
<div id="múltiples-gráficos" class="section level4">
<h4><span class="header-section-number">2.7.0.3</span> Múltiples gráficos</h4>
<p>Facetas</p>
<pre><code>ggplot(comics, aes(x = align)) + 
  geom_bar() +
  facet_wrap(~ gender)</code></pre>
<pre><code>ggplot(email, aes(x= number)) +
  geom_bar() +
  facet_wrap(.~spam)</code></pre>
<pre><code>## 1 - Separate rows according to transmission type, am
p +
  facet_grid(am ~ .)</code></pre>
<pre><code>## 2 - Separate columns according to cylinders, cyl
p +
  facet_grid(. ~ cyl)</code></pre>
<pre><code>## 3 - Separate by both columns and rows 
p +
  facet_grid(am ~ cyl)</code></pre>
<p>Liberar los ejes de los gráficos para que sean distintos:</p>
<pre><code>facer_wrap(~ country, scales=&quot;free_y&quot;)</code></pre>
<p>Eliminar cruces donde no hay datos:</p>
<pre><code>p +
  facet_grid(vore ~ .,scale= &quot;free_y&quot;, space = &quot;free_y&quot;)</code></pre>
<p>Espaciado entre facetas:</p>
<pre><code>library(grid)
z + theme(panel.spacing.x=unit(2, &quot;cm&quot;))</code></pre>
<p>Gráficos verticales</p>
<pre><code>facet_wrap( ~ site, ncol = 1) + ## Facet layer</code></pre>
<p>Espaciado entre facetas:</p>
<pre><code>panel.spacing.y =unit(0.4, &quot;cm&quot;)) +</code></pre>
<p>Ocultar títulos de faceta:</p>
<pre><code>theme(strip.background = element_blank(), strip.text = element_blank())</code></pre>
<p>Facetas de lado</p>
<pre><code>facet_wrap(~ str_to_title(tipo), nrow = 2, scales = &quot;free_y&quot;, 
               strip.position=&quot;left&quot;)</code></pre>
<p>Cortar textos de faceta (sin modificar los factores):</p>
<pre><code>facet_wrap(~egreso, nrow=1, labeller = label_wrap_gen(width=10)) +</code></pre>
</div>
<div id="elementos-y-temas" class="section level4">
<h4><span class="header-section-number">2.7.0.4</span> Elementos y temas</h4>
<pre><code>+ theme()</code></pre>
<p>Dentro de la capa <code>theme()</code>:</p>
<p>Especificar líneas: <code>=element_line()</code></p>
<pre><code>theme(
        axis.line=element_line(color=&quot;red&quot;)
)</code></pre>
<p>Remover un elemento: <code>=element_blank()</code></p>
<pre><code>theme(
    panel.grid=element_blank()
)</code></pre>
<p>Para especificar el eje afectado, se pone un punto y el eje al final del nombre del elemento, por ejemplo: <code>axis.text.x</code></p>
<div id="elementos" class="section level6">
<h6><span class="header-section-number">2.7.0.4.0.1</span> Elementos:</h6>
<ul>
<li><p><code>element_text()</code></p></li>
<li><p><code>element_rect()</code></p></li>
<li><p><code>element_line()</code></p></li>
<li><p><code>element_blank()</code></p></li>
<li><p>Ejes:</p>
<ul>
<li>Marcas en los ejes: <code>axis.ticks</code></li>
<li>Líneas de los ejes: <code>axis.line</code></li>
<li>Etiquetas de los ejes: <code>axis.text</code></li>
</ul></li>
<li><p>Fondos:</p>
<ul>
<li><code>panel.background</code></li>
</ul></li>
<li><p>Rejillas:</p>
<ul>
<li><code>panel.grid.major</code></li>
<li><code>panel.grid.minor</code></li>
</ul></li>
</ul>
</div>
<div id="cambiar-texto" class="section level6">
<h6><span class="header-section-number">2.7.0.4.0.2</span> Cambiar texto</h6>
<ul>
<li>Texto de facetas: <code>strip.text</code></li>
<li>Título de los ejes: <code>axis.title</code></li>
<li>Números en los ejes: <code>axis.text</code></li>
</ul>
<pre><code>plot +
  theme_minimal() +
  ## Customize the &quot;minimal&quot; theme with another custom &quot;theme&quot; call
  theme(
    text = element_text(family = &quot;Bookman&quot;),
    title = element_text(color = &quot;gray25&quot;),
    plot.caption = element_text(color = &quot;gray30&quot;),
    plot.subtitle = element_text(size = 12)
  )</code></pre>
<p>Cambiar margen del texto:</p>
<pre><code>  theme(axis.text.y = element_text(margin = margin(r = -10)),
        axis.text.x = element_text(margin = margin(b = -15))) +</code></pre>
<p>Renombrar ejes:</p>
<pre><code>labs(y=&quot;Cantidad de reclamos y consultas&quot;, x=&quot;Institución o vía de emisión&quot;) </code></pre>
</div>
</div>
<div id="combinar-múltiples-gráficos" class="section level4">
<h4><span class="header-section-number">2.7.0.5</span> Combinar múltiples gráficos</h4>
<p>Unir dos gráficos:</p>
<p>Si usan los mismos datos:</p>
<pre><code>library(gridExtra)
basura_x2 &lt;- grid.arrange(basura_gg, basura_p_gg, ncol=2)</code></pre>
<p>Para dos gráficos distintos:</p>
<pre><code>ggsave(&quot;foo.pdf&quot;, arrangeGrob(plot1, plot2))</code></pre>
<p>Con cowplot:</p>
<pre><code>library(cowplot)
empresas_combinado_cowplot &lt;- plot_grid(empresas_tamaño_porc_gg, 
          empresas_trabajadores_porc_gg,
          leyenda_1,
          nrow = 3,
          align = &quot;v&quot;,
          rel_heights = c(3, 3, 1))  </code></pre>
</div>
<div id="ajustar-espacio-entre-etiquetas-de-ejes-y-gráfico" class="section level4">
<h4><span class="header-section-number">2.7.0.6</span> Ajustar espacio entre etiquetas de ejes y gráfico</h4>
<p>Para acercar o alejar las etiquetas de las barras:</p>
<pre><code>theme(axis.text.y = element_text(margin = margin(r = -3, l = 5))) +</code></pre>
</div>
<div id="acercar-leyenda-al-gráfico" class="section level4">
<h4><span class="header-section-number">2.7.0.7</span> Acercar leyenda al gráfico</h4>
<pre><code>theme(legend.margin = margin(20, 20, 20, 0)) + ##caja de la leyenda</code></pre>
</div>
<div id="cambiar-tamaño-y-hacer-zoom-en-los-datos" class="section level4">
<h4><span class="header-section-number">2.7.0.8</span> Cambiar tamaño y hacer zoom en los datos</h4>
<pre><code>+ coord_cartesian(xlim=c(3,6))</code></pre>
<p>Graficar con la misma relación entre ejes (si las unidades de medida son iguales)</p>
<pre><code>+ coord_equal()</code></pre>
</div>
<div id="guardar-y-aplicar-temas" class="section level4">
<h4><span class="header-section-number">2.7.0.9</span> Guardar y aplicar temas</h4>
<p>Guardar la configuración de elementos de la capa <code>theme</code> en un tema:</p>
<pre><code>mi_tema &lt;- theme(element.axis...)
plot + mi_tema</code></pre>
<p>Expandir temas guardados con nuevas configuraciones:</p>
<pre><code>mi_tema2 &lt;- mi_tema + theme(element...</code></pre>
<p>Ejemplo:</p>
<pre><code>z +
  no_panels +
  theme(plot.background = element_rect(fill = myPink, color=&quot;black&quot;, size=3))</code></pre>
<p>Elegir un tema por defecto (que se aplique a todos lo gráficos):</p>
<pre><code>theme_set(mi_tema)</code></pre>
<p>The arguments for theme_update() are the same as for theme(). When you call theme_update() and assign it to an object (e.g. called old), that object stores the current default theme, and the arguments update the default theme. If you want to restore the previous default theme, you can get it back by using theme_update() again. Let’s see how:_</p>
<pre><code>## 2 - Update the default theme, and at the same time
## assign the old theme to the object old.
old &lt;- theme_update(panel.background = element_blank(),
             legend.key = element_blank(),
             legend.background = element_blank(),
             strip.background = element_blank(),
             plot.background = element_rect(fill = myPink, color = &quot;black&quot;, size = 3),
             panel.grid = element_blank(),
             axis.line = element_line(color = &quot;red&quot;),
             axis.ticks = element_line(color = &quot;red&quot;),
             strip.text = element_text(size = 16, color = myRed),
             axis.title.y = element_text(color = myRed, hjust = 0, face = &quot;italic&quot;),
             axis.title.x = element_text(color = myRed, hjust = 0, face = &quot;italic&quot;),
             axis.text = element_text(color = &quot;black&quot;),
             legend.position = &quot;none&quot;)

## 3 - Display the plot z2 - new default theme used
z2

## 4 - Restore the old default theme
theme_set(old)

## Display the plot z2 - old theme restored
z2</code></pre>
<div id="cargar-temas-con-el-paquete-ggthemes" class="section level8">
<p class="heading"><span class="header-section-number">2.7.0.9.0.0.0.1</span> Cargar temas con el paquete <code>ggthemes</code></p>
<pre><code>library(ggthemes)</code></pre>
</div>
</div>
</div>
<div id="exportar-gráficos" class="section level2">
<h2><span class="header-section-number">2.8</span> Exportar gráficos</h2>
<pre><code>ggsave(file=&quot;grafico7_7_2c.jpg&quot;, plot=basura_x2, dpi=&quot;retina&quot;)</code></pre>
<p>Cambiar DPI para especificar resolución</p>
<pre><code>ggsave(&quot;Gráfico.png&quot;, units=&quot;in&quot;, width=5, height=4, dpi=300)</code></pre>
<p>Exportar animación:</p>
<pre><code>anim_save(&quot;Animación.gif&quot;, animation = last_animation())</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
